<config xmlns="http://tail-f.com/ns/config/1.0">
  <environments xmlns="https://curity.se/ns/conf/base">
    <environment>
      <base-url>http://localhost:8443</base-url>
      <admin-service>
        <http>
          <ssl-server-keystore>default-admin-ssl-key</ssl-server-keystore>
          <web-ui>
          </web-ui>
          <restconf>
          </restconf>
        </http>
      </admin-service>
      <services>
        <zones>
          <default-zone>
            <symmetric-key>data:text/plain;aes,v:S.OW1qOFNmUWlhWVpnQUlWZQ==.0sUOXCTTyevEu5aWRZiaLw==.SHEpqeN23QdeEQlJTiDwsLBPvVRJW9_b_d8VsBjw9VWYaxoQP_SQ4HwLKQcB4yDOkLNMW7c5XpsbP5GliLcwqe30-Kr1jPeXAKf2W1WIuBM=.ymFOu-YYoIYNTyXNFtlqjQPBfWWRPyXl0vohi-XmR0c=</symmetric-key>
          </default-zone>
        </zones>
        <service-role>
          <id>default</id>
          <protocol>http</protocol>
          <endpoints>authentication-service-anonymous</endpoints>
          <endpoints>authentication-service-authentication</endpoints>
          <endpoints>authentication-service-registration</endpoints>
          <endpoints>token-service-anonymous</endpoints>
          <endpoints>token-service-assisted-token</endpoints>
          <endpoints>token-service-authorize</endpoints>
          <endpoints>token-service-introspect</endpoints>
          <endpoints>token-service-revoke</endpoints>
          <endpoints>token-service-session</endpoints>
          <endpoints>token-service-token</endpoints>
          <endpoints>token-service-userinfo</endpoints>
        </service-role>
      </services>
    </environment>
  </environments>
  <profiles xmlns="https://curity.se/ns/conf/base">
    <profile>
      <id>authentication-service</id>
      <type xmlns:auth="https://curity.se/ns/conf/profile/authentication">auth:authentication-service</type>
      <settings>
        <authentication-service xmlns="https://curity.se/ns/conf/profile/authentication">
          <protocols>
            <protocol>
              <id>default-simple-protocol</id>
              <simple-api/>
            </protocol>
          </protocols>
        </authentication-service>
      </settings>
      <endpoints>
        <endpoint>
          <id>authentication-service-anonymous</id>
          <uri>/authn/anonymous</uri>
          <endpoint-kind>auth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-authentication</id>
          <uri>/authn/authentication</uri>
          <endpoint-kind>auth-authentication</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-registration</id>
          <uri>/authn/registration</uri>
          <endpoint-kind>auth-registration</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
    <profile>
      <id>token-service</id>
      <type xmlns:as="https://curity.se/ns/conf/profile/oauth">as:oauth-service</type>
      <expose-detailed-error-messages/>
      <settings>
        <authorization-server xmlns="https://curity.se/ns/conf/profile/oauth">
          <authentication-service>
            <authentication-profile>authentication-service</authentication-profile>
          </authentication-service>
          <client-capabilities>
            <code>
            </code>
            <implicit/>
            <resource-owner-password-credentials>
              <credential-manager>default-credential-manager</credential-manager>
            </resource-owner-password-credentials>
            <client-credentials/>
            <introspection/>
            <token-exchange/>
            <assisted-token>
            </assisted-token>
          </client-capabilities>
          <scopes>
            <scope>
              <id>address</id>
              <description>OpenId Connect address scope</description>
              <claims>address</claims>
            </scope>
            <scope>
              <id>email</id>
              <description>OpenId Connect email scope</description>
              <claims>email</claims>
              <claims>email_verified</claims>
            </scope>
            <scope>
              <id>openid</id>
              <description>Standard OpenID Connect scope</description>
            </scope>
            <scope>
              <id>orders</id>
            </scope>
            <scope>
              <id>phone</id>
              <description>OpenId Connect phone scope</description>
              <claims>phone_number</claims>
              <claims>phone_number_verified</claims>
            </scope>
            <scope>
              <id>profile</id>
              <description>OpenId Connect profile scope</description>
              <claims>birthdate</claims>
              <claims>family_name</claims>
              <claims>gender</claims>
              <claims>given_name</claims>
              <claims>locale</claims>
              <claims>middle_name</claims>
              <claims>name</claims>
              <claims>nickname</claims>
              <claims>picture</claims>
              <claims>preferred_username</claims>
              <claims>profile</claims>
              <claims>updated_at</claims>
              <claims>website</claims>
              <claims>zoneinfo</claims>
            </scope>
            <scope>
              <id>trigger_payments</id>
            </scope>
          </scopes>
          <claims>
            <claim>
              <name>address</name>
              <description>OpenID Connect address claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>birthdate</name>
              <description>OpenID Connect birthdate claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email</name>
              <description>OpenID Connect email claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email_verified</name>
              <description>OpenID Connect email_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>family_name</name>
              <description>OpenID Connect family_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>gender</name>
              <description>OpenID Connect gender claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>given_name</name>
              <description>OpenID Connect given_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>locale</name>
              <description>OpenID Connect locale claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>middle_name</name>
              <description>OpenID Connect middle_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>name</name>
              <description>OpenID Connect name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>nickname</name>
              <description>OpenID Connect nickname claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number</name>
              <description>OpenID Connect phone_number claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number_verified</name>
              <description>OpenID Connect phone_number_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>picture</name>
              <description>OpenID Connect picture claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>preferred_username</name>
              <description>OpenID Connect preferred_username claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>profile</name>
              <description>OpenID Connect profile claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>updated_at</name>
              <description>OpenID Connect updated_at claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>website</name>
              <description>OpenID Connect website claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>zoneinfo</name>
              <description>OpenID Connect zoneinfo claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claims-value-provider>
              <id>account-manager-claims-provider</id>
              <account-manager-claims-provider xmlns="https://curity.se/ns/ext-conf/account-manager-claims-provider">
                <account-manager>
                  <id>default-account-manager</id>
                </account-manager>
              </account-manager-claims-provider>
            </claims-value-provider>
            <claims-mappers>
              <claims-mapper>
                <id>default</id>
                <id_token>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </id_token>
                <userinfo>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </userinfo>
              </claims-mapper>
              <default-claims-mapper>default</default-claims-mapper>
            </claims-mappers>
          </claims>
          <openid-connect>
            <expose-metadata>
            </expose-metadata>
          </openid-connect>
          <client-store>
            <config-backed>
              <client>
                <id>console-client</id>
                <client-name>console-client</client-name>
                <secret>$5$1ACrdEdPKh7qyC/l$KE9.RfjhXtqvP5P.zuSF4a3prVCSBK8zWl6bsKydyz9</secret>
                <audience>api.example.com</audience>
                <scope>openid</scope>
                <scope>orders</scope>
                <scope>trigger_payments</scope>
                <capabilities>
                  <client-credentials/>
                </capabilities>
                <use-pairwise-subject-identifiers>
                  <sector-identifier>console-client</sector-identifier>
                </use-pairwise-subject-identifiers>
              </client>
              <client>
                <id>introspect-client</id>
                <client-name>introspect-client</client-name>
                <secret>$5$B4U/JTO4ZH7bgcJB$ut5slpp4Xk7lMw2LIDxMXmdctcLiwnhqmMWhTtf8sKC</secret>
                <capabilities>
                  <introspection/>
                </capabilities>
                <use-pairwise-subject-identifiers>
                  <sector-identifier>introspect-client</sector-identifier>
                </use-pairwise-subject-identifiers>
              </client>
              <client>
                <id>orders-api-client</id>
                <client-name>orders-api-client</client-name>
                <secret>$5$Jivs3cNjoJJaw.vZ$AGmVCr5K0MFxwtomI32cczZtkD2VO9eg.3umg.kSdZ1</secret>
                <audience>api.example.com</audience>
                <scope>orders</scope>
                <scope>trigger_payments</scope>
                <capabilities>
                  <token-exchange/>
                </capabilities>
                <use-pairwise-subject-identifiers>
                  <sector-identifier>orders-api-client</sector-identifier>
                </use-pairwise-subject-identifiers>
                <properties>
                  <property>
                    <key>custom_jwt_token_exchange</key>
                    <value>true</value>
                  </property>
                </properties>
              </client>
            </config-backed>
          </client-store>
        </authorization-server>
      </settings>
      <endpoints>
        <endpoint>
          <id>token-service-anonymous</id>
          <uri>/oauth/v2/oauth-anonymous</uri>
          <endpoint-kind>oauth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-assisted-token</id>
          <uri>/oauth/v2/oauth-assisted-token</uri>
          <endpoint-kind>oauth-assisted-token</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-authorize</id>
          <uri>/oauth/v2/oauth-authorize</uri>
          <endpoint-kind>oauth-authorize</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-introspect</id>
          <uri>/oauth/v2/oauth-introspect</uri>
          <endpoint-kind>oauth-introspect</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-revoke</id>
          <uri>/oauth/v2/oauth-revoke</uri>
          <endpoint-kind>oauth-revoke</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-session</id>
          <uri>/oauth/v2/oauth-session</uri>
          <endpoint-kind>oauth-session</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-token</id>
          <uri>/oauth/v2/oauth-token</uri>
          <endpoint-kind>oauth-token</endpoint-kind>
          <token-endpoint-procedures>
            <flow>oauth-token-token-exchange</flow>
            <procedure>custom</procedure>
          </token-endpoint-procedures>
        </endpoint>
        <endpoint>
          <id>token-service-userinfo</id>
          <uri>/oauth/v2/oauth-userinfo</uri>
          <endpoint-kind>oauth-userinfo</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
  </profiles>
  <facilities xmlns="https://curity.se/ns/conf/base">
    <data-sources>
      <data-source>
        <id>default-datasource</id>
        <jdbc xmlns="https://curity.se/ns/ext-conf/jdbc">
          <connection-string>data:text/plain;aes,v:S.YUVVdXNYYjVEazAwWlpyZg==.j9CHH1RjWZk_EbqstBGdIA==.nEZs_ia6_kgNKczTdg4zyRc1AOZRqVn3wXeNDtuHvD7a4GN5cPNB9ekJnIM00jEn.jI9F1XA_f2I41EXoyrNL-7W2f2BKaLYzma0HxCD6eqc=</connection-string>
          <connection-timeout>30000</connection-timeout>
          <driver>org.postgresql.Driver</driver>
          <idle-timeout>600000</idle-timeout>
          <max-lifetime>1800000</max-lifetime>
          <max-pool-size>20</max-pool-size>
          <min-idle-pool-size>10</min-idle-pool-size>
          <password>data:text/plain;aes,v:S.S2lEZFd3cGZZcUswVGRnWg==.bptgoAQudnyeULXFmP8MkA==.7UqGo6FoHydPSoMHOn2ENg==.l3JaAZcjbgihU7zEu-cKCqJRp8DaOGwN_C0XSPAv788=</password>
          <use-for-audit>true</use-for-audit>
          <username>postgres</username>
        </jdbc>
      </data-source>
    </data-sources>
    <crypto>
      <ssl>
        <server-keystore>
          <id>default-admin-ssl-key</id>
          <keystore>data:application/p12;aes,v:S.QUVGaW0xZ1lqVWkxeUI4RA==.1k0GmLHrQgeWaGzdo6-bFQ==.uaDq-rZMR67VkMdIXmlMnRs_IIhMQR4tkCwJmbaXRCImFO8sWS1l2VQGhwZOPdoGpH0UHX7oAg5nVTTPL0PNi0VGY61X57GKpolVaOGz1MGJs02mcjWnlWOpCloznMb1PfD_wzPL7Lr7Gsb5FZ3OEKOTG9L7je_QfQkV2pgBvae4QGwk-JFJTVQUVn4XsaUc0kien6zkJjEY5_KH7OHcraG0-PUILgPW862nlrHNwCdYjf5Mixs4eZpXhHpVU1xsLgP_pLxHfvoWMEKWx-FmrztN0eLuPqdykK59-y_WBehWJFHy2FqFoS_T8cvLCY9OQHXajSVK2h6dAugLWOGDkwx0pviruxrvBJxzYaPNl0qQKzSBV_RH4W_yJVEtpk2hUnOmVCxTn3WnhtWeObNSez8cD6iFxDxU6TPG0Ccsz_So7_hzooNhUWMzr9b6rSzwFAnRfwPTXLPshldB1JLMUPY0dT_39MY0Ua7HoT5DiHMICj1Bt0CIitNBY0F5lRnFLmDm8bWlpJpfwP4WvbLnE5VTPA6-P1obxfcEtTtOTtfEhlub5-eUQeQiidbM-Bvx6I59UjFF9iowGx3osKCB6BzdjyMdL0nlKFbhsZAUj66trdiskQORRLIq4xUvbhThbOceIb-s9h07MBO1Mp1_j54sNDRFregwKw-NlzldYV7qP0k9pDvbKLygOtwUxFRO64Ep617U-Xi5y_mfvkTVhd6qmnsOVpctWqFMQX5-wBtKKJzf1NH9aZxMgjTpg8SKqJTIgjlHKxK1LWEMtlsm5b3KEfujfLfdUz9yvKc2yDseGfDKgHzH3nWbpa6KdYaqumJeCWw0SibYsq1oLe-JfASPmwqF7Ir7uGcSRRlqrrbp4ca_4aSiUr9YcAdJkkt1ZpV6-3y3YX0IFXzNDY_7dBDnn7j4XGY09SCeC3Sb6uNDE-r-JrXAs9OoouZFd9_BAuYPfR7aCucnVs5EOzN0njMKWMlbJ9m2rd28pKsbwKqp0RP_zNruUWo0evjg0_lD10NEAyvo0GGwSPrMwCt5W36U_xakBccQn8ppsmi0ha0nQ37jaTUnxlIbYCk4EE2-WXA-s76q27c5I-0LnNyP2JFFuC47D65tGnoeuZhp-so9z8zzZplWlEcjmaTwIs55-tYAsNBkWvhRpsddWyapYJBI4GLRkLl3FgDRO4biO3TvTHpJEVDFNWaabUkCVFSYZRfpDwRgXFxYZJtUlrJDa7z7383Bdr2wwXjNXqlEWPv83AK1D5UC0UlUhK44IoXdQ1u7U2zn1-d330kULh7_LCglVKF0UGSleKigdTA_ELPKrQNx6pU0tEBoVd0qiu06N0i1KMdZbu5AXIcMQ1pFK7FSBXWpPEMIO8t2zVrYTuQA-Szv3EINLtL9rzelXDXZw5H6W_ZPWaPPHUoT8hrDedpxUxZ8yYeZjp283Uq553umP-MxDk6ZqNAH8Y46K1IXkYm3OUrtng3fagoqkw6mdpny3t6IWvncpLffJ4YsMiUHK1iC9nPMYJE2t8RAIVDAK24cznD_k8INZVqTnGBMyCp-kVj7RMV1jmT8PR1-O658SVEu36GqYMzeIzgxydGTHX8wcdLGtCZwW-o3CkhMorcwY4-Y0v2wbNg9vQZ4d1L-AoWGLjNVtNAidjUz5yZE_p1ZiP-5D50xmEu_S-Wu6QH22jL515jR7omSeZACEjS-yOZYNlqo4N4X02DqDr31vRmZhS8ySrTbx4omL8QkLFju_65GwKpzJAhmWtXHEBeK0X_oA5lfxqgkiywWg-tnv2Dom759WMLdBKA3AYVk-_o6D2AMupCVygQvhnnvet49_l8nEKl2Cs4cKbIrcaYHSbeHklYQjVHaslDdhPm-Ena4i__8SR03O1xufBIJB3lJjPCFvbHqu82VM3zIpKIJn3k1gqKLIRHVEt67SrxmdpRpBMhBIHIerOpJc_TN7K1Rg5NNzMGpl2j7YBgdJmBUUU00EoEJm2i7opVnLKS04Noz06hZ1HsvWvoV-ps3nYUdbCuK2WHkwCL-7mjOWB3C8lgaZGPS2im5vcfaY_hHxUjI_x9DhLWyDWRd1m5nPCL4rzUsythTukKu3LLw-3T9yoj7OOJ8b4JAmOIbx33aULlaEwPYMYowcwQ6h5Tj2HfqrFl4pNaxWJGi_Jc2ygiphtlsRhgfUM1OutDOwjokCdK5v8AcRi38Bm0Ma1nkdcEB-AaRUyCuv_6FuZvq3SV8DUL5JnCcmOI4Xd_GFBaYMADe7wkmiH6DfgSfFQgzHwNO62r4mlAYYrAfgn1yZLjYchKSCMHSl_qaX6z9ns-b8t51NKVmAK6MrYECkLM5tXhAdwCwGYpJs_kAhwi170uZu7_42m4XIoc5mPuGxxxXP-uVi0hV3qfEPg9cMTcCiwxiiuhKLwq2sD52rnY6M9Nd2YRuZ6Mp6EeV0c--5ldqmQIz7UlK7rlDz7mkap_6FGe0HHWcJ0T4PBzsykfsxu5cGcdtwlATKapRygUqjb3DsyCu0w6ryB4_lA_moPZGZ5pL_h1Sny3wbGloVBD3h5Gbc-UxSogT8vruF1mVSsg30uN05PBHl1CwATkT6yFSqqRJPTunNHDaDrSaEy27u57TSjxbJMy3yf8kGHg4tMIVn3dnAvpHTPL6ndqoAsy60HgIRjcKIUozDgSumDaaPM8aJS6KsbPy_juRUGlakNvyqGZx8a8czWvLhlZZ9H0VaN-2I9y5I5nBWH1j_8bHBXuY-XCIIAMDLlAioieABqHayt4c0CJCPj5PTAHqbFwaoWUL9YZRDppsnR7Mz1mFXCdGza4qhFRo4SVSFOzTvSadkX7Mo0zLJVjMvdtwphLk9hgiJ1wNMwxU4-tdaOFCrvKmONdBrF7D9iihLzmp3CnbITFfbtE1n6cGWi4QyB05oyHIk71dKVJXdYTTs4mILRbumi6Y-LbQ0z6K58SaYAxXyX8osuEsKKqYsI0QkAR-_7iidvGQnvz31Wjc3QKfpBisLMY_Gi4cHLQ1pzinrx0ASrlfSm4nTgYZFFpmvpFCvYlLmBCRHihGi-xFcDF7HiULdsW5L2bMOdKNzutXFTHOmbruxHK7EM9lij54W3Zdhoy5U07sjjKqpwaS8ee41yZRb49_Vp7itaPDRUNHo0j1dVpf420TJv_Ld59a7LPpnzSdoD5N2nl-Memt7vlfLnNKsOfUHH1EweX5_GXZDs_qmtoYPnusv58iSR2TkgaFCNZXoXAP5zbtHXXPKs4HZaLv8BggZAgWIZLGamS2EEnX48DPwdPKfM9TkiOUhBAYilFZLQS2KqW_C1JaoLvhpfBSNtYKXZlvQEAmW0jlclp9zU-FdwBG2XkcF5TjmwRoLwKCYV3G8TQhQGyRyh1yBZ7rjdqnmWCsYsKi76tdjdPVEMKXg9zQ5Ax9AXXGQGEuK1PTlnzJCqfDFn6atLDJvxHQXfoyX7V4NLWgqjC_w0ZiWYqkjyQta9P95vOp0FisBYaD80L52gz_RnyZwF1TOBgA69-a59LkoRd16KA0Z85jpq27CVUjLVLxvXkclgqP8T_4fhi_Gl8WokrorGWmYDPhtyNX6e9IeT9howLdE_Bl367s_Icg1hsqqEl7zPi3hbx8TFAcyuF72P1kpQLkUMxW.QDDldZcRnG1dWkLK9C6T1OHlQVadvnXzoXcoNaVir8U=</keystore>
        </server-keystore>
      </ssl>
      <signing-keys>
        <signing-key>
          <id>default-signing-key</id>
          <keystore>data:application/p12;aes,v:S.eTBETWpmQW5iaUFHMTVLMQ==.4E6pigmDZblcyh4BL8cUDw==.icv1GcZ8GmfodGMH5mIQoAOKVcuts0AjlU94bQZlm2zCrm4I7iSHddjxlB4ZrZqfLI_KZy-1znODFtX4FMANfrT6Nfq_smUt3hQqmtVkerqOKWUTQkx96oCn11HES6oJxAtWcJnPlavzJhTHevGvolvlN7Ms_jHt8OJg2hRwGkhDAAxefudxLDlExlxdN20KgLxu0Zbq_Qyrjaa-L78Z9JuLtM34ITq5ru4-tuQJzW8kRi4whLJpjPWc4LLxVqSllGpe1ag7QY1cYnHOvZ255brW4WeGLab-MX2QB6HC8-WJSXg6gWvSAGRoxr5HiAM95hn5IxPlBVlLmDhauM1BHU-RR2Fikso87Q3NeVS4Vs9vRcJAPjxa-gkDDanJC4g-I-gAtInkIDKfb5Zd-VA0BCCXt16OgVYvd9IT47OCFGw7gvZCrhR-KaYiTtRq_cM0ulBQME5e0aOz8LGgxFMUuJ6-ThPx2ZdpIa-B1fumdml9aDci27WupjLS8NJ2UBjBEt_tcH5mpR9GD-2lRCxWG5sPUqQev4frqRo1w5Lnham8X6yMZDG2kcqkpmwdF_r4FIUnzkSxtf13T2XEyyydXi2w8b4pEXYl2P-Vh5S6R4JTZ--yoi34FFTQKSVvhiv5lBEUBv483gpeQxgx7UP-7E5-VsM6lff97gAjqV4mzncTvnluQRnNCIu-0-vvrzX0D-r6bwhSvCE6NWg59cAYptW7G6QLLV4JaWIVGNbhC_Wn_SS1WSB0lQ3D-S7mEkkEmiYVAHRN6Bj0-dHcLXJpz47zORrE5biyORuUFAjJMUU0rgz8aSXuMIkeH3SIfYHU0fTnybBGyDpsmwIwLt7iffO_MR9FlVi3_g_0B5_wSUmkQk8e4HZgvjew4_6jyMzmSXszeNGC1KT46TpaLuU8ppGYiXva1-dfYf5fKaJeVyYb58dxifWD8TC8gzRvivWZIAo-UrQqmYxeeCPO-PHBBf4Ak5Pfcwex6AGOneCYT3XXJtk2ZYvPg5HPdH6jrN2QjJH7N60E7Joq2zVaI9iO-ykTu4o_mcQbVoPE_31zRmIoFRtCnvHaUCn_7AExBGm_GGFq7coLDAR70c1MSdvvDq8GcS1YrdjJVzRK9_9ktvSZ8SmbwfuB8G-RiDbJMv8UmynprJYpTPjNo-kNNUc0qPFKUKbPrj0QDKmTuiyNJAJmL_MAGO1_y3vHoBSFVyLqceOc3_J8m8NJIRpLZ2tdjxB7y_1a0lghg5SAVW44vcnzyQ8wQARxhtYg46qRJXCfroxPhjuG44l3bx7lSp4YVPsI93qkeKbp3gqoKaCR7VizqwwzcDo8zn0h2yGYqa9SzDId864F8M3Vqdi3NpQZK0s_G1GZXhBuJ2GL6W8jgaCG-Q4FNbue95jCeuaGHh3F8ft0y1nTFOWN9gqcfjA7k35hfokyuq_R6iffOCj3Qj_gQm5p1Mdq7WSgJGGoyzSS6RkZOKuH2o5tkuBBbRTi4uzBkMySuXJDjsohSxGFEsldyUB5JaY6wE-d57n578vuZH9zcMiPQvI0vMBrBQOQdtKTAMv7k9PBe2XIl74T5-aZs5ECzYDjthtDfiQ5FfalJWBht_r3scMoUW6oIrdZl1kgWcIlSpDB_LCjbBzCwHn6z2-wQ91mbP24pMPZ-AhF0CqaO93d1tTpCBC-o4LzmgY7myu3NnHpVxdU3TzXEURRYMQrq_FDiJvb4ftUZ_9WID2JR2DrsCBvnVz598I5yIPVYg0HXLE-gQc-CXneSeDJseuXQ5mAqBDxjl_xmCyP7VMfqxYEF49AOGJ7o8xVbPI9WSvYQWc4CBk-XcP5CBfPR5CU8iguYHub4_8aTJQY9EsC9YgV-nt3Mpi_Bc2pAZqUknlAsj4ziedxce067-BJU_M2IdQJUQ9iANaJoOtJFiUwDFfW2JT_ZO8qRslmmooBW_qZ2Do1r4-ZB2n9en3-MGlMszSEGILQVCJ_y8AvzGWmX76JyDBriGwYDNSwBwnyaoXS-aRKfyn4E460s8A-baJhhjc8O0W_qEKzMppLgXR157rbcb8cIb2im5sWh5o8Xe7PW7EHfZaDhXmkfDHrZYtSPqMCkEfvhzHX34aET_EElEas4Blp_N1tw2tV-FHDLCLowEUloA_aJw4z7n3-5MzdiwCtlz2cG1oNaifIbq80nGb3VtWQFZcnS43edb5FsRn0r-Q5N-Bp9bO7B_CHKAxBShZc5a7JhFu2PyjcMByiUdvK-m8sPBT7ch52I1f1-wkJ1KYbrd4xbkUdywt0giTu2U2QUZSB1yU5FQv7BxISvZTjJ9c7BNUOGfz5WTAOBgE2DWAeqEqWHY9be0XhipyRmjuw4WCvJuNMH0EYl9PvGn_PDt9815Y6rK8IdXPh1_-hzQ3H9fV7EMhWSqazYAwCHGeOxjkxoAmrpkIBhChR336ny-rZRpxYhrJ4Ow5_M7II6rOdkPuo7GGmo-y2Nmuby4XbT1JdfQHmzLqYHEs42ueIaOLPl9Llep1yMrnrfc6Vn_BSvD1lv8fsqeO7cyfVydeiA73Olncrlqst0idjTcALwMo7s7x_zp8Egm35QKnbAV3T2kHGdRugZB_h2zTpgQZ4TDlmGZ_otf42BAeGgEH5JHT_00nJXe6Fr9_zrH2mGhD1NCvPNrrh77y9tC-gMMDpyuZ-57_Hm1DB4UiaSpDzBpKrEXqVit_jtzS1JvPmfpIPVvQO9dRuGGGvQiSEwIMRt6dQZicaAzgaZ1qVGDkDqlbj23-AhZi_yxCkkUlCk3ti3TIaEYuBAdkbYr5eAarCg5Z9LwV85OStzViT6cmThgxdYeU68zCSlSGva5fmHA6UYmzeXwh3TMXQ1ZyCTL1fscfD3sxlF4vCh2VbE-FGPLvLDUBvahGZcUGN1EdIDD7x_x6ZN3GakPYn4gcBjOOErr6yPu7F8mGkLK02k0PLR3rkU7oGY60wVYOUOco5BKfPHU8EtQ6lDECCHCerN-gV4326uQ7ebq_y-34aSU6S9zf7oXiSTK0DelaAPQDAtB3bvwVhBsYxS2-iCEWsZhV7ilP7ENCGGTveOFNE0Gu1JVs90KhgZcQXOibf4ieRrPPi3xWN-3GtgLzQYs-vlBsrBxNukMKBIVqf5VLp041DrywT35MxF7L4xVncQb0MugJA4h3Z0IXDvQ8P5GZXSL1YVvqthKQXC5DsrOz-ggmgpqdvkJ2MVcKo_mBBqV6W25L-g2qOn6brtx6c2sjAMYMmMdDDWTdSZXOiWt-VuRihuonPCm_58rlF3x2G9MXTg9ATXiz1Ozf5qGONAoF4f5KoJszeaKKT6enjXi9_wItLH9fDsaAjiPjrAkJp2bOLr7oFnWVrg9Pwz5MdaWG43jk20c9Mnr9iz7HP9SJhcNRnjVCEhAXN_GeWEmHDvMV7JW2cQUo2dL5LptCWlXe97XY2S8ngrSq_zis2TPnWzBSlRo3eHoTgRtUIdznJx1vf4rFIainKl2xdngxqoy9brBdmd3tY14SBUOaqQItOLAjXrDHMWHuSKx-aKicHkKWnoebNM2nUOyBHsXv55Wd7G_-WatenWG3zwuBfxO4mP0wvMEgLZietDjH1URsVI4-MiEfrN_llj8OS8XzQF9VzzpsxvgORuYW_r9N3.rWSVu7YTFud9Rjf7sOYYjw2fcsPWU9DeuN1bXkxH3P8=</keystore>
        </signing-key>
      </signing-keys>
      <signature-verification-keys>
        <signature-verification-key>
          <id>default-signature-verification-key</id>
          <keystore>data:application/pem;aes,v:S.ck1GN3hwbXZRa3NOSVNMbw==.atMOaf0yZfWQH6_dded75w==.UrQXPUtmQKcsdgDvVEtgR2f5gd8peMSzw35rC_YRkd-IDO3q3y9ILWwLedRdL6LxpVMU8r7xvg62iMLpkz7JYM4RUufB-rF5Y2wlGCKA6gxg7UOz7QqQf0-FOYgXVeDZvZa_KgdFq1QZRodU-rC_Kuc3OilRlQT8f-kT4iXRHBdDuEGcUnDmPpgaifhiwzR7kvBWwPF0Br0wJOkzsYtnj5gnTsXb3wd8i6fb-cOSm_fu9hcpTtRDbHvbVCgt3Z50zHLGhbr1-jeedGcKk0NC3J0k0vVK03TU4JzU3id3ol8JcPdCWgl27eopHpL65LtGNn797KeJ6CBKjbQhBssfg9GQFOf607eZ0KNCRxhsjj2mHo76iOS_4oqqk4Y00ow1NtGY3SZROJ2dImuy0znPam6eC7IPYGm48IOAeoiwgMLqVhFWomWfh-HNKloB1_nUwfEnfxlkFl-CYt6AGdrD4wCuhZISU2tCZanpKDE9gcGUprxK5a7BsL6-kmBKcD1Xy6XbXFpnUd7Mb2regKJWYwBu8vyrvjFCLAmVeJjzU9PCgBzDXSGfFobDHsI4NsZylUO4UMus5xBoVZBtWFpGV-1k0lG_ZoXDuioZsxlH9MseemeHxE58EOJfD_kd86ar7dGE9gBVT8uyYlSnAF74Qmgq2Te9ba4QZtwBaCxyxW7-OxWX6SQDXPrLbzeW2pEH6ESiznWJNBlJ7cd9DloKDn1-5Y7yqFBOT882sFzmXLbuB0od5jic1QJGTaB0hqjLpDPgD4EIRW8_TbxAseOeeRAB-DUrLrl_Aj_uYp0hflLV6huSnq0GK4R46rn_f3rC6TQgfWXECyAvw2CeqWVTi9Kx22XAeAvALh8vIgWUi974wwlmimsxNUe_t-xX3bBcExmJcxLARMT3uiKMp9OJJjNq-m4KRaS_IabEwHvrz37p5FQYdj-d6JrDsIZ7hXNwoylUjdy0zJllwtvtPHB8waZWv-4Tq8K_JKM1vYD20yNBJKtKDv5Mcl5KuHcrnZBM7F7dk4o9NAS2VQc71C8FbBR2F643Ve2255ydqA0TO4uj2pMZ-4BxRpwXrpuMDjJcp2MOmMjFfpQiu5fiEmuDLWVPkRKJXrSfn6kE02Rp3ojTOOSWPSD5uMfb0Mdp6C3lvXEp_BkS4sW6lDCtO7XEx74bIi43TvLxcmGP3YWNj5znlKmfm9QMVIXrr5523imtz-gue3IOxwAifMF5sMyxqinR2LrRKKRWEU0-UWQmSChaP8Z0xa-nFpUOHhyFkYCloZ85oWXISf02IkWyEABL44UxKoj9wx1_wB25USO1utP916-ngs--pARM5rI7R5H67o_aAH9_bt2LC0OAcNYxSyGWFS6HuxhwOcpdLpfy3IBghHEyBFjnghVPF5twprS76onSoyImnImaU_L-v1kBubMC3TjSQtJ-_S9_zsbtPWH4z1NgUVusnKGcw7P8hl_TaobKiaicHzeiGkObb9hmQBiWIBBfy4rtDsGf-LsixpJHnbcUcMSbs25Rw8euXMhGyyne0uiYqFsYhBow9UZMv2CKDjQcAQjz1v5Fg6yd7ENaTz_uFLSxEGebev6hDs6xkDmZE_-ENnDLuOisP6282IhVvyP47H-aL8mVU7mo_DorPFhXO4SEJqEK3UlssI4m.DEgUERTIhtNNQesDXyRbzwJ5e49DffCx1c-l6yaIVQU=</keystore>
        </signature-verification-key>
      </signature-verification-keys>
    </crypto>
    <caching-services>
      <default-caching-service>
        <data-source>default-datasource</data-source>
      </default-caching-service>
    </caching-services>
  </facilities>
  <processing xmlns="https://curity.se/ns/conf/base">
    <license-key></license-key>
    <procedures>
      <token-procedure>
        <id>custom</id>
        <flow>oauth-token-token-exchange</flow>
        <script>LyoqCiAqIEBwYXJhbSB7c2UuY3VyaXR5LmlkZW50aXR5c2VydmVyLnByb2NlZHVyZXMuY29udGV4dC5Ub2tlbkV4Y2hhbmdlUHJvY2VkdXJlQ29udGV4dH0gY29udGV4dAogKi8KZnVuY3Rpb24gcmVzdWx0KGNvbnRleHQpIHsKICAgIHZhciBhY2Nlc3NUb2tlbkRhdGEgPSBjb250ZXh0LmdldERlZmF1bHRBY2Nlc3NUb2tlbkRhdGEoY29udGV4dC5kZWxlZ2F0aW9uKTsKCiAgICB2YXIgaXNzdWVkQWNjZXNzVG9rZW47CiAgICBpZiAoY29udGV4dC5jbGllbnQucHJvcGVydGllc1snY3VzdG9tX2p3dF90b2tlbl9leGNoYW5nZSddID09ICd0cnVlJykgewoKICAgICAgICB2YXIgb3JkZXJfdHJhbnNhY3Rpb25faWQgPSBjb250ZXh0LnJlcXVlc3QuZ2V0Rm9ybVBhcmFtZXRlcignb3JkZXJfdHJhbnNhY3Rpb25faWQnKTsKICAgICAgICB2YXIgZXZlbnRfbmFtZSA9IGNvbnRleHQucmVxdWVzdC5nZXRGb3JtUGFyYW1ldGVyKCdldmVudF9uYW1lJyk7CiAgICAgICAgdmFyIGV2ZW50X3BheWxvYWRfaGFzaCA9IGNvbnRleHQucmVxdWVzdC5nZXRGb3JtUGFyYW1ldGVyKCdldmVudF9wYXlsb2FkX2hhc2gnKTsKICAgICAgICBpZiAob3JkZXJfdHJhbnNhY3Rpb25faWQgJiYgZXZlbnRfbmFtZSAmJiBldmVudF9wYXlsb2FkX2hhc2gpIHsKICAgICAgICAgICAgYWNjZXNzVG9rZW5EYXRhLm9yZGVyX3RyYW5zYWN0aW9uX2lkID0gb3JkZXJfdHJhbnNhY3Rpb25faWQ7CiAgICAgICAgICAgIGFjY2Vzc1Rva2VuRGF0YS5ldmVudF9uYW1lID0gZXZlbnRfbmFtZTsKICAgICAgICAgICAgYWNjZXNzVG9rZW5EYXRhLmV2ZW50X3BheWxvYWRfaGFzaCA9IGV2ZW50X3BheWxvYWRfaGFzaDsKICAgICAgICB9CgogICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpOwogICAgICAgIHZhciBmdXR1cmUgPSBuZXcgRGF0ZSgpOwogICAgICAgIGZ1dHVyZS5zZXRGdWxsWWVhcihub3cuZ2V0RnVsbFllYXIoKSArIDEpOwogICAgICAgIGFjY2Vzc1Rva2VuRGF0YS5leHAgPSBNYXRoLnJvdW5kKGZ1dHVyZS5nZXRUaW1lKCkgLyAxMDAwKTsKCiAgICAgICAgaXNzdWVkQWNjZXNzVG9rZW4gPSBjb250ZXh0LmdldERlZmF1bHRBY2Nlc3NUb2tlbkp3dElzc3VlcigpLmlzc3VlKGFjY2Vzc1Rva2VuRGF0YSwgY29udGV4dC5kZWxlZ2F0aW9uKTsKCiAgICB9IGVsc2UgewogICAgICAgIAogICAgICAgIGlzc3VlZEFjY2Vzc1Rva2VuID0gY29udGV4dC5hY2Nlc3NUb2tlbklzc3Vlci5pc3N1ZShhY2Nlc3NUb2tlbkRhdGEsIGNvbnRleHQuZGVsZWdhdGlvbik7CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgICBzY29wZTogYWNjZXNzVG9rZW5EYXRhLnNjb3BlLAogICAgICAgIGFjY2Vzc190b2tlbjogaXNzdWVkQWNjZXNzVG9rZW4sCiAgICAgICAgdG9rZW5fdHlwZTogJ2JlYXJlcicsCiAgICAgICAgZXhwaXJlc19pbjogc2Vjb25kc1VudGlsKGFjY2Vzc1Rva2VuRGF0YS5leHApCiAgICB9Owp9</script>
      </token-procedure>
      <token-procedure>
        <id>transaction-procedure</id>
        <flow>oauth-token-token-exchange</flow>
        <script>LyoqCiAqIEBwYXJhbSB7c2UuY3VyaXR5LmlkZW50aXR5c2VydmVyLnByb2NlZHVyZXMuY29udGV4dC5Ub2tlbkV4Y2hhbmdlUHJvY2VkdXJlQ29udGV4dH0gY29udGV4dAogKi8KZnVuY3Rpb24gcmVzdWx0KGNvbnRleHQpIHsKCXZhciBhY2Nlc3NUb2tlbkRhdGEgPSBjb250ZXh0LmdldERlZmF1bHRBY2Nlc3NUb2tlbkRhdGEoY29udGV4dC5kZWxlZ2F0aW9uKTsKCiAgICB2YXIgb3JkZXJfdHJhbnNhY3Rpb25faWQgPSBjb250ZXh0LnJlcXVlc3QuZ2V0Rm9ybVBhcmFtZXRlcignb3JkZXJfdHJhbnNhY3Rpb25faWQnKTsKICAgIHZhciByZXF1ZXN0X2NvbnRlbnRfaGFzaCA9IGNvbnRleHQucmVxdWVzdC5nZXRGb3JtUGFyYW1ldGVyKCdyZXF1ZXN0X2NvbnRlbnRfaGFzaCcpOwogICAgaWYgKG9yZGVyX3RyYW5zYWN0aW9uX2lkICYmIHJlcXVlc3RfY29udGVudF9oYXNoKSB7CiAgICAgICAgYWNjZXNzVG9rZW5EYXRhLm9yZGVyX3RyYW5zYWN0aW9uX2lkID0gb3JkZXJfdHJhbnNhY3Rpb25faWQ7CiAgICAgICAgYWNjZXNzVG9rZW5EYXRhLnJlcXVlc3RfY29udGVudF9oYXNoID0gcmVxdWVzdF9jb250ZW50X2hhc2g7CiAgICB9CgoJLy92YXIgaXNzdWVkQWNjZXNzVG9rZW4gPSBjb250ZXh0LmFjY2Vzc1Rva2VuSXNzdWVyLmlzc3VlKGFjY2Vzc1Rva2VuRGF0YSwgY29udGV4dC5kZWxlZ2F0aW9uKTsKICAgIHZhciBpc3N1ZWRBY2Nlc3NUb2tlbiA9IGNvbnRleHQuZ2V0RGVmYXVsdEFjY2Vzc1Rva2VuSnd0SXNzdWVyKCkuaXNzdWUoYWNjZXNzVG9rZW5EYXRhLCBjb250ZXh0LmRlbGVnYXRpb24pOwoKCXJldHVybiB7CgkJc2NvcGU6IGFjY2Vzc1Rva2VuRGF0YS5zY29wZSwKCQlhY2Nlc3NfdG9rZW46IGlzc3VlZEFjY2Vzc1Rva2VuLAoJCXRva2VuX3R5cGU6ICdiZWFyZXInLAoJCWV4cGlyZXNfaW46IHNlY29uZHNVbnRpbChhY2Nlc3NUb2tlbkRhdGEuZXhwKQoJfTsKfQ==</script>
      </token-procedure>
    </procedures>
    <account-managers>
      <account-manager>
        <id>default-account-manager</id>
        <enable-registration>
          <account-verification-method>no-verification</account-verification-method>
        </enable-registration>
        <account-data-source>default-datasource</account-data-source>
      </account-manager>
    </account-managers>
    <credential-managers>
      <credential-manager>
        <id>default-credential-manager</id>
        <Sha2WithSha256>
        </Sha2WithSha256>
        <data-source-backed>
          <data-source-id>default-datasource</data-source-id>
        </data-source-backed>
      </credential-manager>
    </credential-managers>
  </processing>
  <nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm">
    <write-default>permit</write-default>
    <groups>
      <group>
        <name>admin</name>
        <user-name>admin</user-name>
      </group>
    </groups>
    <rule-list>
      <name>admin</name>
      <group>admin</group>
      <rule>
        <name>any-access</name>
        <action>permit</action>
      </rule>
    </rule-list>
    <rule-list>
      <name>any-group</name>
      <group>*</group>
      <rule>
        <name>tailf-aaa-authentication</name>
        <module-name>tailf-aaa</module-name>
        <path>/aaa/authentication/users/user[name='$USER']</path>
        <access-operations>read update</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-aaa-user</name>
        <module-name>tailf-aaa</module-name>
        <path>/user[name='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-webui-user</name>
        <module-name>tailf-webui</module-name>
        <path>/webui/data-stores/user-profile[username='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
    </rule-list>
  </nacm>
  <aaa xmlns="http://tail-f.com/ns/aaa/1.1">
    <authentication>
      <users>
        <user>
          <name>admin</name>
          <uid>0</uid>
          <gid>0</gid>
          <password>$5$m7y0GfCi$uuWsjLks5Wf8k2oPKy09h1MffQeqXYg6R7JdhT.eR68</password>
          <ssh_keydir>/opt/idsvr/home/admin/.ssh</ssh_keydir>
          <homedir>/opt/idsvr/home/admin</homedir>
        </user>
      </users>
    </authentication>
    <ios>
      <level>
        <nr>0</nr>
        <prompt>\h> </prompt>
      </level>
      <level>
        <nr>15</nr>
        <prompt>\h# </prompt>
      </level>
      <privilege>
        <mode>exec</mode>
        <level>
          <nr>0</nr>
          <command>
            <name>action</name>
          </command>
          <command>
            <name>autowizard</name>
          </command>
          <command>
            <name>enable</name>
          </command>
          <command>
            <name>exit</name>
          </command>
          <command>
            <name>help</name>
          </command>
          <command>
            <name>startup</name>
          </command>
        </level>
        <level>
          <nr>15</nr>
          <command>
            <name>configure</name>
          </command>
        </level>
      </privilege>
    </ios>
  </aaa>
</config>