<config xmlns="http://tail-f.com/ns/config/1.0">
  <environments xmlns="https://curity.se/ns/conf/base">
    <environment>
      <base-url>http://localhost:8443</base-url>
      <admin-service>
        <http>
          <ssl-server-keystore>default-admin-ssl-key</ssl-server-keystore>
          <web-ui>
          </web-ui>
          <restconf>
          </restconf>
        </http>
      </admin-service>
      <services>
        <zones>
          <default-zone>
            <symmetric-key>data:text/plain;aes,v:S.MGFPZHlhWGk1VmJLMmdPSQ==.jyIdMRMnu-dbFwjP5MWcjw==.K0dHimlhY4wctIdcZOJRp4BGxAvNdWgmYs4R6geSsBBQWbIbMxBJm7Kx-wjXfXziqjNWqveY4QmZuvmj5LGWbyDFpXNskJQitZ4UgfgJLCs=.BWKZPD8DIDX8CUfgnZcFsu6vg_4pWOCQ-ZsEopSERAc=</symmetric-key>
          </default-zone>
        </zones>
        <service-role>
          <id>default</id>
          <protocol>http</protocol>
          <endpoints>authentication-service-anonymous</endpoints>
          <endpoints>authentication-service-authentication</endpoints>
          <endpoints>authentication-service-registration</endpoints>
          <endpoints>token-service-anonymous</endpoints>
          <endpoints>token-service-assisted-token</endpoints>
          <endpoints>token-service-authorize</endpoints>
          <endpoints>token-service-introspect</endpoints>
          <endpoints>token-service-revoke</endpoints>
          <endpoints>token-service-session</endpoints>
          <endpoints>token-service-token</endpoints>
          <endpoints>token-service-userinfo</endpoints>
        </service-role>
      </services>
    </environment>
  </environments>
  <profiles xmlns="https://curity.se/ns/conf/base">
    <profile>
      <id>authentication-service</id>
      <type xmlns:auth="https://curity.se/ns/conf/profile/authentication">auth:authentication-service</type>
      <settings>
        <authentication-service xmlns="https://curity.se/ns/conf/profile/authentication">
          <protocols>
            <protocol>
              <id>default-simple-protocol</id>
              <simple-api/>
            </protocol>
          </protocols>
        </authentication-service>
      </settings>
      <endpoints>
        <endpoint>
          <id>authentication-service-anonymous</id>
          <uri>/authn/anonymous</uri>
          <endpoint-kind>auth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-authentication</id>
          <uri>/authn/authentication</uri>
          <endpoint-kind>auth-authentication</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-registration</id>
          <uri>/authn/registration</uri>
          <endpoint-kind>auth-registration</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
    <profile>
      <id>token-service</id>
      <type xmlns:as="https://curity.se/ns/conf/profile/oauth">as:oauth-service</type>
      <expose-detailed-error-messages/>
      <settings>
        <authorization-server xmlns="https://curity.se/ns/conf/profile/oauth">
          <authentication-service>
            <authentication-profile>authentication-service</authentication-profile>
          </authentication-service>
          <client-capabilities>
            <code>
            </code>
            <implicit/>
            <resource-owner-password-credentials>
              <credential-manager>default-credential-manager</credential-manager>
            </resource-owner-password-credentials>
            <client-credentials/>
            <introspection/>
            <token-exchange/>
            <assisted-token>
            </assisted-token>
          </client-capabilities>
          <scopes>
            <scope>
              <id>address</id>
              <description>OpenId Connect address scope</description>
              <claims>address</claims>
            </scope>
            <scope>
              <id>email</id>
              <description>OpenId Connect email scope</description>
              <claims>email</claims>
              <claims>email_verified</claims>
            </scope>
            <scope>
              <id>openid</id>
              <description>Standard OpenID Connect scope</description>
            </scope>
            <scope>
              <id>orders</id>
            </scope>
            <scope>
              <id>phone</id>
              <description>OpenId Connect phone scope</description>
              <claims>phone_number</claims>
              <claims>phone_number_verified</claims>
            </scope>
            <scope>
              <id>profile</id>
              <description>OpenId Connect profile scope</description>
              <claims>birthdate</claims>
              <claims>family_name</claims>
              <claims>gender</claims>
              <claims>given_name</claims>
              <claims>locale</claims>
              <claims>middle_name</claims>
              <claims>name</claims>
              <claims>nickname</claims>
              <claims>picture</claims>
              <claims>preferred_username</claims>
              <claims>profile</claims>
              <claims>updated_at</claims>
              <claims>website</claims>
              <claims>zoneinfo</claims>
            </scope>
            <scope>
              <id>trigger_payments</id>
            </scope>
          </scopes>
          <claims>
            <claim>
              <name>address</name>
              <description>OpenID Connect address claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>birthdate</name>
              <description>OpenID Connect birthdate claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email</name>
              <description>OpenID Connect email claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email_verified</name>
              <description>OpenID Connect email_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>family_name</name>
              <description>OpenID Connect family_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>gender</name>
              <description>OpenID Connect gender claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>given_name</name>
              <description>OpenID Connect given_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>locale</name>
              <description>OpenID Connect locale claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>middle_name</name>
              <description>OpenID Connect middle_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>name</name>
              <description>OpenID Connect name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>nickname</name>
              <description>OpenID Connect nickname claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number</name>
              <description>OpenID Connect phone_number claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number_verified</name>
              <description>OpenID Connect phone_number_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>picture</name>
              <description>OpenID Connect picture claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>preferred_username</name>
              <description>OpenID Connect preferred_username claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>profile</name>
              <description>OpenID Connect profile claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>updated_at</name>
              <description>OpenID Connect updated_at claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>website</name>
              <description>OpenID Connect website claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>zoneinfo</name>
              <description>OpenID Connect zoneinfo claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claims-value-provider>
              <id>account-manager-claims-provider</id>
              <account-manager-claims-provider xmlns="https://curity.se/ns/ext-conf/account-manager-claims-provider">
                <account-manager>
                  <id>default-account-manager</id>
                </account-manager>
              </account-manager-claims-provider>
            </claims-value-provider>
            <claims-mappers>
              <claims-mapper>
                <id>default</id>
                <id_token>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </id_token>
                <userinfo>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </userinfo>
              </claims-mapper>
              <default-claims-mapper>default</default-claims-mapper>
            </claims-mappers>
          </claims>
          <openid-connect>
            <expose-metadata>
            </expose-metadata>
          </openid-connect>
          <client-store>
            <config-backed>
              <client>
                <id>console-client</id>
                <client-name>console-client</client-name>
                <secret>$5$1ACrdEdPKh7qyC/l$KE9.RfjhXtqvP5P.zuSF4a3prVCSBK8zWl6bsKydyz9</secret>
                <audience>api.example.com</audience>
                <scope>openid</scope>
                <scope>orders</scope>
                <scope>trigger_payments</scope>
                <capabilities>
                  <client-credentials/>
                </capabilities>
                <use-pairwise-subject-identifiers>
                  <sector-identifier>console-client</sector-identifier>
                </use-pairwise-subject-identifiers>
              </client>
              <client>
                <id>introspect-client</id>
                <client-name>introspect-client</client-name>
                <secret>$5$B4U/JTO4ZH7bgcJB$ut5slpp4Xk7lMw2LIDxMXmdctcLiwnhqmMWhTtf8sKC</secret>
                <capabilities>
                  <introspection/>
                </capabilities>
                <use-pairwise-subject-identifiers>
                  <sector-identifier>introspect-client</sector-identifier>
                </use-pairwise-subject-identifiers>
              </client>
              <client>
                <id>orders-api-client</id>
                <client-name>orders-api-client</client-name>
                <secret>$5$Jivs3cNjoJJaw.vZ$AGmVCr5K0MFxwtomI32cczZtkD2VO9eg.3umg.kSdZ1</secret>
                <audience>api.example.com</audience>
                <scope>orders</scope>
                <scope>trigger_payments</scope>
                <capabilities>
                  <token-exchange/>
                </capabilities>
                <use-pairwise-subject-identifiers>
                  <sector-identifier>orders-api-client</sector-identifier>
                </use-pairwise-subject-identifiers>
                <properties>
                  <property>
                    <key>custom_jwt_token_exchange</key>
                    <value>true</value>
                  </property>
                </properties>
              </client>
            </config-backed>
          </client-store>
        </authorization-server>
      </settings>
      <endpoints>
        <endpoint>
          <id>token-service-anonymous</id>
          <uri>/oauth/v2/oauth-anonymous</uri>
          <endpoint-kind>oauth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-assisted-token</id>
          <uri>/oauth/v2/oauth-assisted-token</uri>
          <endpoint-kind>oauth-assisted-token</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-authorize</id>
          <uri>/oauth/v2/oauth-authorize</uri>
          <endpoint-kind>oauth-authorize</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-introspect</id>
          <uri>/oauth/v2/oauth-introspect</uri>
          <endpoint-kind>oauth-introspect</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-revoke</id>
          <uri>/oauth/v2/oauth-revoke</uri>
          <endpoint-kind>oauth-revoke</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-session</id>
          <uri>/oauth/v2/oauth-session</uri>
          <endpoint-kind>oauth-session</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-token</id>
          <uri>/oauth/v2/oauth-token</uri>
          <endpoint-kind>oauth-token</endpoint-kind>
          <token-endpoint-procedures>
            <flow>oauth-token-token-exchange</flow>
            <procedure>custom</procedure>
          </token-endpoint-procedures>
        </endpoint>
        <endpoint>
          <id>token-service-userinfo</id>
          <uri>/oauth/v2/oauth-userinfo</uri>
          <endpoint-kind>oauth-userinfo</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
  </profiles>
  <facilities xmlns="https://curity.se/ns/conf/base">
    <data-sources>
      <data-source>
        <id>default-datasource</id>
        <jdbc xmlns="https://curity.se/ns/ext-conf/jdbc">
          <connection-string>data:text/plain;aes,v:S.dWg5SGROMEpmT3FjeDNUTQ==.NWPBKZlkVErlJsUn4G0hsg==.yZcvD6JkKDnCqi8d3CYBhvi4laf8Q0_arR9DSURex6Re2eieeI5HspzaHR11PMGs.Dfr0pZSmiFMyTRGruWriUTF0sXwPkwFPqC4JrOrfmJU=</connection-string>
          <connection-timeout>30000</connection-timeout>
          <driver>org.postgresql.Driver</driver>
          <idle-timeout>600000</idle-timeout>
          <max-lifetime>1800000</max-lifetime>
          <max-pool-size>20</max-pool-size>
          <min-idle-pool-size>10</min-idle-pool-size>
          <password>data:text/plain;aes,v:S.QnZETDVjcGxSQkFwMFhOMg==.noHshkzPPdp9eMacI54gZw==.kbUdTtchFUUlb8WCzmT0xA==.0BYkIhesANXW4Uy3ejOz6fpLl23jT6D-8vtmPhdq0tA=</password>
          <use-for-audit>true</use-for-audit>
          <username>postgres</username>
        </jdbc>
      </data-source>
    </data-sources>
    <crypto>
      <ssl>
        <server-keystore>
          <id>default-admin-ssl-key</id>
          <keystore>data:application/p12;aes,v:S.bGFZWkFTZ3dzYkExWE1EVw==.eZCxiFspv4ZqsqmN-B0YDA==.fks8stpXNc5RB1QIFA8iN17AevOd2gGJrtY78OYJokbevxMRszDZnPgHYmD3t9qf-vCkkMOsV4PdgNpVFuYbFeZpyCxbnuy6bbAwmFkuiGPhmmod4Lei9TBQLsf_9MVXLNN3F_pOykguwzaMxpj42a_55dpoT3zGVXGS0fWYDGIOCSETlPmS5k2armnjP-X08xY9IrNN8d_dHYH2HjRPzzGKt_llBYA_8_ytUpy3Lt2OLtFfwzNiTnEtmbbmfcWd-pxwBpVJiz3MUkJJKXXD3YPaFxKf_-0n3bOPtozlxjssCWWY342t89d38GFBzUwWkmi0OY2ve2boO3MjO5BX2cHE0_nKeX-QomzTaDGEe8JOa4Q9ofuMsPCUy-4nf0vgVRxteK4ViAK45BS4dWb3cGyYNTlZ9Yvg5BxV204GPcl0rYRpXqeGDFTRVigxLqI7NjCq2Cbn-QgV-OHaDBSfZlJzjD_m0thCY2xwcNmVCC6tYqtObVn6kQ6cYyXeWG2y55A8szmmI8UgFW-Lnx9bPx55tHR86Lmf_lOgeDZAIDPh-cgbr7RrxekKf74VNsCrZ0_vDzXZKVPzfY0hIDIcMZBc_caREXV4Fhp9QGJSuZmtK6rq9b-6g41GGpJ-4062M1CRWouPm09ZKR0rV8umT6p-C7zwxYrccx1Ki2hAkx94li_5JHgaNKMxjyClx9exjs8lk_iorStSoSv13iO6S4gXoRKP_uOk_1hzfns_gs9yKkfI971PLPiuwpmOSb-oWWxUjQt4HE1KURJooQM0M06wsjEo8R3KMTprHVqWYEwj9CsfkuJsSm01U7sfwePTcIFnHvQc6B_g0jbRSpzpurV8BHgImjEedQNOgvibwDgQ4-L5kE2VZshFa9hDBOQQugYEEbX-M07x0CqT6M26l9GKYZOn1XYvg_ax0jtK9eb0-qpXgKhi4K-GuuQP1K4x_e06S5mfUjaX7sxma5vkguJ7CSdlsXUQhoLf-se8bEej8A-PAZ8nqHdp7uS_V_2wMxpMKGCnwBklqijzbK1Tt6--295d60KBI0faQCQlRVLhRAcX_tfXzRMQhvudOSLOXDHApIJWxX2q0E5mZJUa5oNZftMEqm_nkuTYw1HITy_Noq-i2IJxLQ9a4XL-HP7qy3mYlbLgSTaMC29Jfys_HfTcJBMYwbPNyTjzjRf1glm54S2rszF0Iopyw5GwJeTsNMKH5dsE-_d5y5Hzf2atSdYYYBynAfTDhZildNg7UIz0PHKctBaHY8dAO-s-lbNGjuCM6-nDhhmkcdRKwwpUwzYZZfAgl9hYLy1xm4B6m4oRDyCSQ7zQuLX4I5mX1zEXWCuMeFU4DNi0hDoeJklZZWe_eS5D9lN5HuDqEURfO_g8gzugE3039Z54qV1yL03Lg01ZJZpdiheN0YeX40EfPKkS-gi_EViSXKdKRvVcjW68WCoE15HQGY2gC5ecFC5a2TmPjC_vm9QmREouU-woBE_IWzam5WFdw4zxUCd1NkcQWAS7SvJrPuDT_7BICOkoAsyVen5a319-l7k0WprKJb58zCvJHiH7MDkvbf8VsgJFHSHzA8oJtIzqpwx6jtrHJWUjI59x_lBEsEHv_Ti2-ES3ipysCeeaLLFK4KhmgFKsfpXJvJjxpalpBSnv7Ahh_u-nR1AdLTwD0dPCdc4mRb0P7ER8bF7HZjMavTQ8uVzWN92mTys4RlGpnRpmt8pkKxqpHLq91Jfrs8--8XN2AOvvZPRulKH58W4ClV8Yykwkc22GSwlKfP6doJ-WVXOmTVM-2Tp6tH4RcpNcfnNjwNrku2Nbpwgwfai0aJxkxOKRtl5G_skLwGBOHog2Zhnvft6irTelH7tQAv3ogUjsmw5EXkdu2VaP7TiCthnlJC11XO770bXz6Jkb475WarSu-vNWhhXA-tH-2SSIcP_zNR3v2ErKl0hOUN5E_vSHC7Gem2p2tn1J4WjoJ2FtQdgKamOjUPNwOXYvJ7NkQOQG2hCZBN7oNThJQifvK20YjGALX9aemK_v5Nmw0GuCxLzztut3fVPNmUbWKcp3EDLL3apOkxivWgMyyhcnV3qHVSQN6JpSj0bK6E3LWIrcYz5QNxSoT9LeZ-fkVCjjNdI8Mgdf7uLN1TEvzSn_dUXiOS8qClBBKBkP9rmM9wa3VNj3-jb_6sKk995fNaZ4DQfnhwjmXfUJwBoPjm1dOFjtbpmkpJgtjkcW8yWoUbo1TYWK4wntP78SOzD33fE55YydEqnYZxVpI4JtUX3oZa_N11oFkzcu9KtbsYqRsRz8q4xiLnXDTHHFu__aSn-mXXAmGdiXZk2Mk0NhgTSfj7QZGvQJ64sJ2mGOH2p6Uhn_pLFBGRGw-DE7COqQAflUiagH4Pz_apnDr_EBL3Gd7hHlbnM7Q-DlsxhV-l4XP2HF-aELNldk-vQQ4NyJ2uabjd-Enktm5q_6po7iDKcNYQi5qbA70SQ7zumaq4eZoPsBVE_xOsgHQEF1LAlMrk9QozBs5oQNBFC0Lb1v13bo01BTh0PUXxNKvT5kOTOVl4XTGl5-Bn8Euo8nILvEd6ORYP4FcfxP8KorwHPJwVDIK9WhQIQTVHCHY7-WocJolI4oDXVCGiusRpaw_aO63WCfmGg7z7kQu9Q6oMJnK25prGCTnIqSeKTCQQX7_Ftjhh_fTvNLv1snWWJ7REuiRkCVWBefG7l4UMCc0U2xctkfeI7SaZoXjJ_Xonk9WyL6x57o0MloBYw_C1JaxWsRsRug43R0jysmDeM5cBvPIyUmKvrhKRnqm8L93HQGWdy8S2voOp8tZJB4j34twrN0pAxFGs0wwvChuyIUfZ5P7DKw4rwOQ-RBHqivLDmpUgnfmIDCL1NzBGYgoXZ6qoGsCY2Ra9GFaNbNCU8XuQd-jcj86AEuBP64ClwymXXG9nFFC2R1eBreQOJhfCej6nQajlYgvrR0baso0nKpMTrtR3ZUuN4VBgqLKSfQ8kwD7sxph_LXzwBrTs8B4x_lqKgvABtp2Yth0szmTYrgRiwRrkkEgh47VSvLThw31AF3VgnT78oXeMZChBtiA5n7TT-NBpgbudKyjeCw8UqEm-5HZdNzPePHn4oX2l-mUapRKO1uwyXAQzDuork05MrTkEoSkGMOX60i7cGHbYwqETr4kR2rV5n0nDlCZYhkJ6RoKn88AyNy1e5H-TlmkuUz6q4n-hS7tFgWFrVrdfhj7cRb9Q2jDsbOhuEUu21yxoa4zHW0mXf2amszQ1yO-QSxamwa7hPs1ASobLbJcFuKXd4s21ZWxLW7zw4AzUcXNsgJ9fITlN4Ayz8m5-JLrjOqJRJtvKBX1cYsj9VInPtJ2ENbFmiYREFmmK9nOq71WEdSJc4lNmhuhxf_uFes4s1Eiwx2saBU_XKpz7_d1v6UdOeuz41KBa8Y8VPwavRW0i5OO69WH_apaEAZMN6H-PW84UKgrh7xPC2Y-LUqj-fVgSSiTZw7JguwJoJkQ8l0jnYn4DdUMzxeKIQyPbgyZBFWcti_fGJVxxvppCMDnC33ssfvxKlhyZ2FpIGPUzAeVJhZ0YLBklU87Vd8RhCMcEwG31hl5hxk9qCNsFwTmQ_8BIpzCABbw7lw_Yv5wnh50eM6AfcoqGjztydy.u9URjtKhWRKdOJLLaEYFjcGVHABdL071Mg6880XUWNQ=</keystore>
        </server-keystore>
      </ssl>
      <signing-keys>
        <signing-key>
          <id>default-signing-key</id>
          <keystore>data:application/p12;aes,v:S.bkMzcjFwUEdhdzU4WmViNQ==.1oEcTIbLY_Tzioj9t684Cg==._Ine7AjhVA8cOs5DtOy1upIcmifISHvpLObxSJZiuxiPctYiWbjHUqhbZKCO4xniWS1zrBbQry4FMILUWvaYDi93PZ000JBcoMLpohXh9mRk30id8tazFq5tJl3R7Ezf5iTLxVAiCmTUZnoKoIde0e6dNtc6QYJzl7rYS76qbTA8wtCTkitN9SmGJS9UcKv1RtTvSmfJqR_oesMaw8E7I7Ho1D8RzZW8FHFjobXD9xUoFlGEidv9URV3dDPyTqwXWUuBuP_HQFcX2pvsgQFqhl0xgfPzasY826nnBCeu13PhSh-1u72iXIWtBkUAfb9HD33f4YbMDWFQDRtGsAV-2CiL_BGveGJAZRYM1eVTZx4-NjGKg2m5Hfy33n1W51xdBdbT_CQsjJ7ogyiq9pizPn80c3FsuB5LvnsS7DWCaT6b1Afa9pt7qS7LkGVF2JllCstdXDw91LfW6JGaL_OEf8FzTQTCYQbqUH7lbv6EHcJRJ1a53P-5Sg7yOe-QQ3mY6uBT-6Sp9bRO_DYMuHAnPT4RsBDCCzNlIuRj9zMP2upxeJEF-B3Cr2RS-u-wW7Eoae2sihqsoWvtckDR3xTxEJzvHP1xiJCUwQJqkY_bPNidJ2ZLLm3Dv2tJiKJWRtKv1yd9CT1Uk7bJV3TjxCc9WefIcgQonYN9cpx5z2qVBuAKERkZ6ZKE06LmEBCG3BGe0GKBxjt1v2Y53on8stJeeMm3G48lNklR_6DLT8w2cF-sOVyYshJQenBcwT8b-ua6IdB7cJGOQEXLLKYNFlO5qa2WqMMrayETu9WhqlnX0tQXXI_VqE9tXc0fDQDs4cwR8YGo4CKRZCVrBchfmQ7wIILhDSNJ0IQDTDVgr3fKMdex2HlhNuhacGQZ2Aqha7uXQfjiZRsruUMRRVD7Lgk0OTUv4BYRksxMBYcaRJoRt1qzdIZTfUME2uUE9ICsM3KvFrmRd1SI4CO6DCWQs3Ox8u-rHBc3u2ReWGxDYzKDdA_JnPD7hlEYgDhOtcGyySpFyKJ-KvC_UUoZpPoiyT22uEUqNcP0Ly5e1IvjjE4sHgtj4SU0ZKbaU3QGAxxGchb6KARQQ-nXFlhCnZOqVMlYB4nmhE9sjLRujeePWtlp-Xj1NGdZ-jZUEVY2D_3eDQyxBgTysgmOLkf9cKpYSKCHTqEzFTWHyqRRzaJRU97V9soU0jnpdNCiuL3JWfubAdtNaY6oyXkyI0m0lV7_lm5QZZxr163_OukGeHkKt62LRsuBT4f5sYTfVVozXkXNm6fh5rvHCaO10OTe-IOo0qCW8DbcoFsqUZDL8rHMhmGTxxXxDY5PylfCAU9os3Caoge7qWAs8BFGUoTuTqihdqxOiqTZYirjSp7O89RA2-2uhgjNr7Xo4XvkAAtPmY7inqSfXjW6yUfIWvmqq-lDb8IwfzWm2LTrOAYn4t_RJqhoZrOdgFzbQIlRXkzr-IgFwjs0P4OI764QhIrIOJA0YwqBrpKHibEcF4kIOhhOU2xRT7gWnPlafsF16bhvq9WKHeWjBUVwi9e1xn6unFnIocswttdvPteH6I5fE-CrN38C9PaRb1Y1vP-dsFAcctjGrhkUZ1RK-h55YwlWQVNAuDwdVhIwarAgjKvF8Nw-bAD1_0varRC2LAI71VRF2CfRcelhh7isIdLSzOhWRMXxv0Yks_Yo-_1YYXmxIGD3FP1hh_7YgKB3Sdqg2wTiNMh7gBOIufL9zAjoy9el47RTAYPWZtzuk8x-yuT-BdVAUJeyTgTNriCwCSTI_givy44_eAlvVOFYr-VEmfH5gXZS-qKiMYyZ05qMdRbLnTCmiRY2f0sjyRVtjTEx90u7lbROewGxdqUxenb_s48yNiC98NPli3FWRlwL5RMfzdf8E-RqL-3ya8J2WPXiZuUG2Bgu_5kPh4R0rVvnCZ7_2aYNHt1yOo9DYAqzegQVFaQpXYBe7hrICQhdwYBnW9rEYm6mkyGF7Ph9sd1LN9MNJvvgYS485cIn53AzILqp2Ycl2KuOknQn8eRAgpfKJ3Bejq0X5f93Fei0xRTU5VU2rN7C5gsLIrgyhj7RUF2LAXcvobF7figMbU12YIRSx-PTDx5_5lhmZaKf7do8H73o_9_e5pG7L6co9HfKSrVdyjr4it--HsDAXwMyG1pyXx0RwUJmrxQeelKQnl4ISUonRCygFgI-gAXpvRnoFQ-aByRsSGN7CcjJQ6c_XUR4wLC_Qp4n4GK_ThcjuZoIEO-0G0iNYx87VQzB9cUJ7tlPh8dHpws1Bri8kXuqn9PCKKYo1TDK-coqehckdN-tUTsbugRCHrgPTgF5g-nppMemrqT_g1h0cUnn_eqaEZCSLu1LGahHT-EwFlm6fmdaN27fZblQ1J2zwZwEOJ1YyRyn-JDn0Ody00xdwIG1E13pingb7L3C9y3XiI39cpPm8cxjXZXRMgBobANsqFOWo8Se68vhsjlVR4VRrcYbBuO8THPsx2CHXnuNxg8N9Kw5gw4AGHA4WisRtbFJwErkJRBlh2Vi3gYJQcxmK27-OxKGB0fEIdlFNYjL65ykc9pWR8zAFRR_FtcI7c3Lv9Aa-hB-1Qf-J9UFgsBp5Q3b9wHEMtinhOPSrAn9k4vRU6JjYlG88g6kYgja16VdRebFplrU1Ac8mU3omvBN-P06DykhuC0FGVReo0cECXOXWXTyqiDtml8cm4IKjul4m-I5TsFazVSOpGrXGuRe7Fc1yQTtSII0lE15w-4GGKwolkmI56xBzLnEjD3QCr1CQ-qaUrOasDLxTQLrhIbb0ZFeBJIT2ztYqRbmF-xeomlujbfSXOp1mj75oZrUTOSGJG7Bobu55NN-VuzRDZxjNr2nHtV4d4li60drqBPqpnwF0BsRoLS1d_7BZht5iNb_UQI_9SOnNRozI2tE2PD_YRSjhfU8QjeDZR-uwzFSq376CrLvxOJdCDUHg_c4hDMSUVwDkT96TGRWw9qH_1gvszEGVsIL7uMNfGbGK_VkMnwiUlAS38IR04TDJEOp9qxPJGkRF8oWtUx3FXy-q664FCCNAcaLMBj05-c60FYOPKgcpcG99HyfiR5CGve3GusPUD9ABb1xFf3YJ2JNF9_0g4kDnhZGWUSp8qtOMj80L1UkUulZBf3SAIOnpvBpDZCbAYuzS7UpgtUg_p2mDuIAZOsdZH2fdfdUafFLvi3V6CiGSTd4d7zZ93HfON2Z0YSAFXjPHKcweat985GDcyPyO84HTyxislas0UTJFJozB9G-3piD7JbRTRWTFRgJYMytNmPstjpd5074cdY0Dj0eOAylKQRBRzfpeGJJ30oNT2neohlygF_xKWUZhFBfsfY18hP_BKYbPKyg94GZno8wlBjiwS6JxHZVmtJj7EP6yRNGKC4TYI7Wxix9dK5pD_6cBmBjFJDLb6WB_d3jb6hBtbBtdbugZNPsrXSDHQ0Sat_ucvwkXeYcKcGKeMt9iebMKaFp8oz10bbrTlQGkegqe4qz5_fAONbAhvAXS_OlDg2P1jkpULSbL9WBTVK7DGyqqUB0o1QipBuveePFvFrx1LC_dHEh_TUkaVaXKppD7r5ISdhnwiY90RyWVBnggtIR44wSI_YN3HbDOqI-EzolttPLtwg-p5m7YxYVxtlZ.q1P-MLKdnkaYTOK-qPeOjV-B1JzpCMhIkke04CKWZdM=</keystore>
        </signing-key>
      </signing-keys>
      <signature-verification-keys>
        <signature-verification-key>
          <id>default-signature-verification-key</id>
          <keystore>data:application/pem;aes,v:S.SzNrY0VEQTdBNDB3eU1NOQ==.UhQ2D8KIyQtBMn1gSs-Tyw==.Z2W-n30CEVfsJHHbdjRsO6EXSWlvbWNtgJFZeRX0UFYhcpSou7mKNASOfovoR3h34Vt3YXzv_w0H2ziARbb1jiyQN91qGtoJ-7-Uae2ix-U9MkKIDsSza5mqmcWH5wUp8IX_4NYNunQO21jfyi_SyZCxFiroaYoYniSmsXwHWjZctqSUCYtCGcwLZyuIK2wQOnCDoNDIUiLkB2onYawagZKL1oY5m5PT4LwpgaAf2PzD2nZdWeT588gQIvpKWH2mT5RUN828UI_47Ko9rqLa_fnGEHN38NGhPoNs-KMRiGzy4gKINRn1Toh0uKuBdjoIAj9bsmzlJET8mFIj-0B7R5Q38vk09Nq-Bhk3fMKGhZNdWQXjVFjtoaOxJ-QDak5J__JBs4Yk0f4Wi7k65AlLfhjqUmS9Tt0YKOu_f8kBnXM5NTdSs0BOWOve3_BQ6x0W7il7lM8gX7FPKUTAOb4rstHYk4NHNnjC5yOLJ-SICVdv26MMK5v-b6a3Pexrui_cy78ZpPkv33VoP0QI2kl3KevWA1r8c71-j_ucBNyJfdkBmBD2NGmNHHo1B6f8O41VMYVvHNqsVFxVQyS8IhQ_YulMThBbAcNXGnLtqyDgM8NqR83XoZfJzAgESujV3KvPUUiHB_70nvxQP4RZifqGdeLT1q1lN7TQy8G5GJRbP7smaseL6BXV9BnIg4So9LITVKlL3jjK7CAWN8B-pFnVhAmKvWEIE_6FbzYMEYHstpD8viGApgP5F18NgGcZrJLmjZzwQTG1nlUH0FheKfu92IM8WfodDkpouJeeiN_nA8sREte1nHP9Rt81jbt7K3pAi_F2mgd9eE0835W2vr9dfWuI1rQLt0sN75_89xeOMrMOpBY3ZD6WHSPwmI8oMDjygM9YVcUCUZrwigcEi8sFLlsViZsiuisKic-zSCojko0twQkHgal9Zyhvj8ZGkQlFxrzZdC-2btc7dMrL-FdWnG68lSLGBmwR6mReeSozJttD7EPb2qk95biejZHHFAuJ-I5TDiEvzCBacO4K4Jl7iEKboWNiIIdcfu-CfTo6CYyu6ggPh6uMn90yrZ2i70GMi-7JGdcO88252Wl5godxTdDipOOZ9-BVe4pxaRPesR-3ynfLRLvj2Q3cnV7ydERBkGyKuZgymZFfS1wG_wZpWbt2D5NNYkndbOKVRBuyP1_rZ6BJI84N21sxKjvxkuq7qAnWbwA1xexVECCNWK-yrVIcyCWV2p_BBe5hp6kpNbXwn561kLd3fiUBNGnFAGvfoI3QgqOQ_W5idELuHO5_boAOVU_eX1M3s88tg04johxzLfr-sCxuNTNCVLZpykfwkPPUI01kdpiuRbYA8LlxWgjcCFXetxP2Hfb0-YZSv9uvC1lIZ9-mXJWTWPR7hHlmdXYpqU5F4wXmvoc2046gUe7B2qJpJme-F8FCDVsEh6jBZziNyYT5E3f1Eu-ZytcJ73hDJiF-X4IdpPd0tjcHTy7WhqOiBN5asThJfXscyL0_tihcwfdZjOQGtsN370q6FUXYZxyRva8cQoIYkaGeAXpOoZ00N6vDVeqgADaf7UjDx54QrUnfkomQ-zStDTH2CUVGV8fO3TD3W0U0G1MOnwH4ZZdBSueo0Dq0SJ5GfPFTiiSVM8XyyeGrKjFoVKgi.LuaZ1wGyYUdEbBhtCKwNcyhISSZc9BAA2-8dr5wrjhc=</keystore>
        </signature-verification-key>
      </signature-verification-keys>
    </crypto>
    <caching-services>
      <default-caching-service>
        <data-source>default-datasource</data-source>
      </default-caching-service>
    </caching-services>
  </facilities>
  <processing xmlns="https://curity.se/ns/conf/base">
    <license-key></license-key>
    <procedures>
      <token-procedure>
        <id>custom</id>
        <flow>oauth-token-token-exchange</flow>
        <script>LyoqCiAqIEBwYXJhbSB7c2UuY3VyaXR5LmlkZW50aXR5c2VydmVyLnByb2NlZHVyZXMuY29udGV4dC5Ub2tlbkV4Y2hhbmdlUHJvY2VkdXJlQ29udGV4dH0gY29udGV4dAogKi8KZnVuY3Rpb24gcmVzdWx0KGNvbnRleHQpIHsKICAgIHZhciBhY2Nlc3NUb2tlbkRhdGEgPSBjb250ZXh0LmdldERlZmF1bHRBY2Nlc3NUb2tlbkRhdGEoY29udGV4dC5kZWxlZ2F0aW9uKTsKCiAgICB2YXIgaXNzdWVkQWNjZXNzVG9rZW47CiAgICBpZiAoY29udGV4dC5jbGllbnQucHJvcGVydGllc1snY3VzdG9tX2p3dF90b2tlbl9leGNoYW5nZSddID09ICd0cnVlJykgewoKICAgICAgICB2YXIgb3JkZXJfdHJhbnNhY3Rpb25faWQgPSBjb250ZXh0LnJlcXVlc3QuZ2V0Rm9ybVBhcmFtZXRlcignb3JkZXJfdHJhbnNhY3Rpb25faWQnKTsKICAgICAgICB2YXIgZXZlbnRfcGF5bG9hZF9oYXNoID0gY29udGV4dC5yZXF1ZXN0LmdldEZvcm1QYXJhbWV0ZXIoJ2V2ZW50X3BheWxvYWRfaGFzaCcpOwogICAgICAgIGlmIChvcmRlcl90cmFuc2FjdGlvbl9pZCAmJiBldmVudF9wYXlsb2FkX2hhc2gpIHsKICAgICAgICAgICAgYWNjZXNzVG9rZW5EYXRhLm9yZGVyX3RyYW5zYWN0aW9uX2lkID0gb3JkZXJfdHJhbnNhY3Rpb25faWQ7CiAgICAgICAgICAgIGFjY2Vzc1Rva2VuRGF0YS5ldmVudF9wYXlsb2FkX2hhc2ggPSBldmVudF9wYXlsb2FkX2hhc2g7CiAgICAgICAgfQoKICAgICAgICB2YXIgbm93ID0gbmV3IERhdGUoKTsKICAgICAgICB2YXIgZnV0dXJlID0gbmV3IERhdGUoKTsKICAgICAgICBmdXR1cmUuc2V0RnVsbFllYXIobm93LmdldEZ1bGxZZWFyKCkgKyAxKTsKICAgICAgICBhY2Nlc3NUb2tlbkRhdGEuZXhwID0gTWF0aC5yb3VuZChmdXR1cmUuZ2V0VGltZSgpIC8gMTAwMCk7CgogICAgICAgIGlzc3VlZEFjY2Vzc1Rva2VuID0gY29udGV4dC5nZXREZWZhdWx0QWNjZXNzVG9rZW5Kd3RJc3N1ZXIoKS5pc3N1ZShhY2Nlc3NUb2tlbkRhdGEsIGNvbnRleHQuZGVsZWdhdGlvbik7CgogICAgfSBlbHNlIHsKICAgICAgICAKICAgICAgICBpc3N1ZWRBY2Nlc3NUb2tlbiA9IGNvbnRleHQuYWNjZXNzVG9rZW5Jc3N1ZXIuaXNzdWUoYWNjZXNzVG9rZW5EYXRhLCBjb250ZXh0LmRlbGVnYXRpb24pOwogICAgfQoKICAgIHJldHVybiB7CiAgICAgICAgc2NvcGU6IGFjY2Vzc1Rva2VuRGF0YS5zY29wZSwKICAgICAgICBhY2Nlc3NfdG9rZW46IGlzc3VlZEFjY2Vzc1Rva2VuLAogICAgICAgIHRva2VuX3R5cGU6ICdiZWFyZXInLAogICAgICAgIGV4cGlyZXNfaW46IHNlY29uZHNVbnRpbChhY2Nlc3NUb2tlbkRhdGEuZXhwKQogICAgfTsKfQ==</script>
      </token-procedure>
      <token-procedure>
        <id>transaction-procedure</id>
        <flow>oauth-token-token-exchange</flow>
        <script>LyoqCiAqIEBwYXJhbSB7c2UuY3VyaXR5LmlkZW50aXR5c2VydmVyLnByb2NlZHVyZXMuY29udGV4dC5Ub2tlbkV4Y2hhbmdlUHJvY2VkdXJlQ29udGV4dH0gY29udGV4dAogKi8KZnVuY3Rpb24gcmVzdWx0KGNvbnRleHQpIHsKCXZhciBhY2Nlc3NUb2tlbkRhdGEgPSBjb250ZXh0LmdldERlZmF1bHRBY2Nlc3NUb2tlbkRhdGEoY29udGV4dC5kZWxlZ2F0aW9uKTsKCiAgICB2YXIgb3JkZXJfdHJhbnNhY3Rpb25faWQgPSBjb250ZXh0LnJlcXVlc3QuZ2V0Rm9ybVBhcmFtZXRlcignb3JkZXJfdHJhbnNhY3Rpb25faWQnKTsKICAgIHZhciByZXF1ZXN0X2NvbnRlbnRfaGFzaCA9IGNvbnRleHQucmVxdWVzdC5nZXRGb3JtUGFyYW1ldGVyKCdyZXF1ZXN0X2NvbnRlbnRfaGFzaCcpOwogICAgaWYgKG9yZGVyX3RyYW5zYWN0aW9uX2lkICYmIHJlcXVlc3RfY29udGVudF9oYXNoKSB7CiAgICAgICAgYWNjZXNzVG9rZW5EYXRhLm9yZGVyX3RyYW5zYWN0aW9uX2lkID0gb3JkZXJfdHJhbnNhY3Rpb25faWQ7CiAgICAgICAgYWNjZXNzVG9rZW5EYXRhLnJlcXVlc3RfY29udGVudF9oYXNoID0gcmVxdWVzdF9jb250ZW50X2hhc2g7CiAgICB9CgoJLy92YXIgaXNzdWVkQWNjZXNzVG9rZW4gPSBjb250ZXh0LmFjY2Vzc1Rva2VuSXNzdWVyLmlzc3VlKGFjY2Vzc1Rva2VuRGF0YSwgY29udGV4dC5kZWxlZ2F0aW9uKTsKICAgIHZhciBpc3N1ZWRBY2Nlc3NUb2tlbiA9IGNvbnRleHQuZ2V0RGVmYXVsdEFjY2Vzc1Rva2VuSnd0SXNzdWVyKCkuaXNzdWUoYWNjZXNzVG9rZW5EYXRhLCBjb250ZXh0LmRlbGVnYXRpb24pOwoKCXJldHVybiB7CgkJc2NvcGU6IGFjY2Vzc1Rva2VuRGF0YS5zY29wZSwKCQlhY2Nlc3NfdG9rZW46IGlzc3VlZEFjY2Vzc1Rva2VuLAoJCXRva2VuX3R5cGU6ICdiZWFyZXInLAoJCWV4cGlyZXNfaW46IHNlY29uZHNVbnRpbChhY2Nlc3NUb2tlbkRhdGEuZXhwKQoJfTsKfQ==</script>
      </token-procedure>
    </procedures>
    <account-managers>
      <account-manager>
        <id>default-account-manager</id>
        <enable-registration>
          <account-verification-method>no-verification</account-verification-method>
        </enable-registration>
        <account-data-source>default-datasource</account-data-source>
      </account-manager>
    </account-managers>
    <credential-managers>
      <credential-manager>
        <id>default-credential-manager</id>
        <Sha2WithSha256>
        </Sha2WithSha256>
        <data-source-backed>
          <data-source-id>default-datasource</data-source-id>
        </data-source-backed>
      </credential-manager>
    </credential-managers>
  </processing>
  <nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm">
    <write-default>permit</write-default>
    <groups>
      <group>
        <name>admin</name>
        <user-name>admin</user-name>
      </group>
    </groups>
    <rule-list>
      <name>admin</name>
      <group>admin</group>
      <rule>
        <name>any-access</name>
        <action>permit</action>
      </rule>
    </rule-list>
    <rule-list>
      <name>any-group</name>
      <group>*</group>
      <rule>
        <name>tailf-aaa-authentication</name>
        <module-name>tailf-aaa</module-name>
        <path>/aaa/authentication/users/user[name='$USER']</path>
        <access-operations>read update</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-aaa-user</name>
        <module-name>tailf-aaa</module-name>
        <path>/user[name='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-webui-user</name>
        <module-name>tailf-webui</module-name>
        <path>/webui/data-stores/user-profile[username='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
    </rule-list>
  </nacm>
  <aaa xmlns="http://tail-f.com/ns/aaa/1.1">
    <authentication>
      <users>
        <user>
          <name>admin</name>
          <uid>0</uid>
          <gid>0</gid>
          <password>$5$m7y0GfCi$uuWsjLks5Wf8k2oPKy09h1MffQeqXYg6R7JdhT.eR68</password>
          <ssh_keydir>/opt/idsvr/home/admin/.ssh</ssh_keydir>
          <homedir>/opt/idsvr/home/admin</homedir>
        </user>
      </users>
    </authentication>
    <ios>
      <level>
        <nr>0</nr>
        <prompt>\h> </prompt>
      </level>
      <level>
        <nr>15</nr>
        <prompt>\h# </prompt>
      </level>
      <privilege>
        <mode>exec</mode>
        <level>
          <nr>0</nr>
          <command>
            <name>action</name>
          </command>
          <command>
            <name>autowizard</name>
          </command>
          <command>
            <name>enable</name>
          </command>
          <command>
            <name>exit</name>
          </command>
          <command>
            <name>help</name>
          </command>
          <command>
            <name>startup</name>
          </command>
        </level>
        <level>
          <nr>15</nr>
          <command>
            <name>configure</name>
          </command>
        </level>
      </privilege>
    </ios>
  </aaa>
</config>