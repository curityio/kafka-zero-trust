<config xmlns="http://tail-f.com/ns/config/1.0">
  <environments xmlns="https://curity.se/ns/conf/base">
    <environment>
      <base-url>http://localhost:8443</base-url>
      <admin-service>
        <http>
          <ssl-server-keystore>default-admin-ssl-key</ssl-server-keystore>
          <web-ui>
          </web-ui>
          <restconf>
          </restconf>
        </http>
      </admin-service>
      <services>
        <zones>
          <default-zone>
            <symmetric-key>data:text/plain;aes,v:S.UHFCUWpBZ1pNYXFSd1J3Sg==.5L8FYFijCyxRrn-PLtLMGA==.VpDGJX8kfFDP6mb47S2hwnH23W4IKO3JRTGI6xle40nYG6e7fCBX0QUj0zVa_LUOSsWPUVoMtTNeyTWGgTkg0sFIbedrcRb5ztvIrEgoIT4=.Uwm4iQEkNDmkZplRD2ubqPaU22xuAhmkJoS1ESuywNA=</symmetric-key>
          </default-zone>
        </zones>
        <service-role>
          <id>default</id>
          <protocol>http</protocol>
          <endpoints>authentication-service-anonymous</endpoints>
          <endpoints>authentication-service-authentication</endpoints>
          <endpoints>authentication-service-registration</endpoints>
          <endpoints>token-service-anonymous</endpoints>
          <endpoints>token-service-assisted-token</endpoints>
          <endpoints>token-service-authorize</endpoints>
          <endpoints>token-service-introspect</endpoints>
          <endpoints>token-service-revoke</endpoints>
          <endpoints>token-service-session</endpoints>
          <endpoints>token-service-token</endpoints>
          <endpoints>token-service-userinfo</endpoints>
        </service-role>
      </services>
    </environment>
  </environments>
  <profiles xmlns="https://curity.se/ns/conf/base">
    <profile>
      <id>authentication-service</id>
      <type xmlns:auth="https://curity.se/ns/conf/profile/authentication">auth:authentication-service</type>
      <settings>
        <authentication-service xmlns="https://curity.se/ns/conf/profile/authentication">
          <authenticators>
            <authenticator>
              <id>UsernamePassword</id>
              <html-form xmlns="https://curity.se/ns/conf/authenticators/html-form">
                <account-manager>default-account-manager</account-manager>
                <credential-manager>default-credential-manager</credential-manager>
              </html-form>
            </authenticator>
          </authenticators>
          <protocols>
            <protocol>
              <id>default-simple-protocol</id>
              <simple-api/>
            </protocol>
          </protocols>
        </authentication-service>
      </settings>
      <endpoints>
        <endpoint>
          <id>authentication-service-anonymous</id>
          <uri>/authn/anonymous</uri>
          <endpoint-kind>auth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-authentication</id>
          <uri>/authn/authentication</uri>
          <endpoint-kind>auth-authentication</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-registration</id>
          <uri>/authn/registration</uri>
          <endpoint-kind>auth-registration</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
    <profile>
      <id>token-service</id>
      <type xmlns:as="https://curity.se/ns/conf/profile/oauth">as:oauth-service</type>
      <expose-detailed-error-messages/>
      <settings>
        <authorization-server xmlns="https://curity.se/ns/conf/profile/oauth">
          <account-manager>default-account-manager</account-manager>
          <authentication-service>
            <authentication-profile>authentication-service</authentication-profile>
          </authentication-service>
          <client-capabilities>
            <code>
            </code>
            <implicit/>
            <resource-owner-password-credentials>
              <credential-manager>default-credential-manager</credential-manager>
            </resource-owner-password-credentials>
            <client-credentials/>
            <introspection/>
            <oauth-token-exchange/>
            <assisted-token>
            </assisted-token>
          </client-capabilities>
          <scopes>
            <scope>
              <id>address</id>
              <description>OpenId Connect address scope</description>
              <claims>address</claims>
            </scope>
            <scope>
              <id>email</id>
              <description>OpenId Connect email scope</description>
              <claims>email</claims>
              <claims>email_verified</claims>
            </scope>
            <scope>
              <id>openid</id>
              <description>Standard OpenID Connect scope</description>
            </scope>
            <scope>
              <id>orders</id>
            </scope>
            <scope>
              <id>phone</id>
              <description>OpenId Connect phone scope</description>
              <claims>phone_number</claims>
              <claims>phone_number_verified</claims>
            </scope>
            <scope>
              <id>profile</id>
              <description>OpenId Connect profile scope</description>
              <claims>birthdate</claims>
              <claims>family_name</claims>
              <claims>gender</claims>
              <claims>given_name</claims>
              <claims>locale</claims>
              <claims>middle_name</claims>
              <claims>name</claims>
              <claims>nickname</claims>
              <claims>picture</claims>
              <claims>preferred_username</claims>
              <claims>profile</claims>
              <claims>updated_at</claims>
              <claims>website</claims>
              <claims>zoneinfo</claims>
            </scope>
            <scope>
              <id>payments</id>
            </scope>
          </scopes>
          <claims>
            <claim>
              <name>address</name>
              <description>OpenID Connect address claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>birthdate</name>
              <description>OpenID Connect birthdate claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email</name>
              <description>OpenID Connect email claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email_verified</name>
              <description>OpenID Connect email_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>family_name</name>
              <description>OpenID Connect family_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>gender</name>
              <description>OpenID Connect gender claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>given_name</name>
              <description>OpenID Connect given_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>locale</name>
              <description>OpenID Connect locale claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>middle_name</name>
              <description>OpenID Connect middle_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>name</name>
              <description>OpenID Connect name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>nickname</name>
              <description>OpenID Connect nickname claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number</name>
              <description>OpenID Connect phone_number claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number_verified</name>
              <description>OpenID Connect phone_number_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>picture</name>
              <description>OpenID Connect picture claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>preferred_username</name>
              <description>OpenID Connect preferred_username claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>profile</name>
              <description>OpenID Connect profile claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>updated_at</name>
              <description>OpenID Connect updated_at claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>website</name>
              <description>OpenID Connect website claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>zoneinfo</name>
              <description>OpenID Connect zoneinfo claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claims-value-provider>
              <id>account-manager-claims-provider</id>
              <account-manager-claims-provider xmlns="https://curity.se/ns/ext-conf/account-manager-claims-provider">
                <account-manager>
                  <id>default-account-manager</id>
                </account-manager>
              </account-manager-claims-provider>
            </claims-value-provider>
            <claims-mappers>
              <claims-mapper>
                <id>default</id>
                <id_token>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </id_token>
                <userinfo>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </userinfo>
              </claims-mapper>
              <default-claims-mapper>default</default-claims-mapper>
            </claims-mappers>
          </claims>
          <openid-connect>
            <expose-metadata>
            </expose-metadata>
          </openid-connect>
          <client-store>
            <config-backed>
              <client>
                <id>console-client</id>
                <client-name>console-client</client-name>
                <no-authentication>true</no-authentication>
                <redirect-uris>http://localhost:3003</redirect-uris>
                <proof-key>
                  <require-proof-key>true</require-proof-key>
                </proof-key>
                <refresh-token-ttl>disabled</refresh-token-ttl>
                <audience>api.example.com</audience>
                <scope>openid</scope>
                <scope>orders</scope>
                <scope>profile</scope>
                <user-authentication>
                </user-authentication>
                <capabilities>
                  <code>
                  </code>
                </capabilities>
                <validate-port-on-loopback-interfaces>true</validate-port-on-loopback-interfaces>
              </client>
              <client>
                <id>introspect-client</id>
                <client-name>introspect-client</client-name>
                <secret>$5$B4U/JTO4ZH7bgcJB$ut5slpp4Xk7lMw2LIDxMXmdctcLiwnhqmMWhTtf8sKC</secret>
                <capabilities>
                  <introspection/>
                </capabilities>
              </client>
              <client>
                <id>orders-api-client</id>
                <client-name>orders-api-client</client-name>
                <secret>$5$Jivs3cNjoJJaw.vZ$AGmVCr5K0MFxwtomI32cczZtkD2VO9eg.3umg.kSdZ1</secret>
                <audience>api.example.com</audience>
                <scope>orders</scope>
                <scope>payments</scope>
                <capabilities>
                  <oauth-token-exchange/>
                </capabilities>
                <properties>
                  <property>
                    <key>custom_token_exchange</key>
                    <value>true</value>
                  </property>
                </properties>
              </client>
            </config-backed>
          </client-store>
        </authorization-server>
      </settings>
      <endpoints>
        <endpoint>
          <id>token-service-anonymous</id>
          <uri>/oauth/v2/oauth-anonymous</uri>
          <endpoint-kind>oauth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-assisted-token</id>
          <uri>/oauth/v2/oauth-assisted-token</uri>
          <endpoint-kind>oauth-assisted-token</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-authorize</id>
          <uri>/oauth/v2/oauth-authorize</uri>
          <endpoint-kind>oauth-authorize</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-introspect</id>
          <uri>/oauth/v2/oauth-introspect</uri>
          <endpoint-kind>oauth-introspect</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-revoke</id>
          <uri>/oauth/v2/oauth-revoke</uri>
          <endpoint-kind>oauth-revoke</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-session</id>
          <uri>/oauth/v2/oauth-session</uri>
          <endpoint-kind>oauth-session</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-token</id>
          <uri>/oauth/v2/oauth-token</uri>
          <endpoint-kind>oauth-token</endpoint-kind>
          <token-endpoint-procedures>
            <flow>oauth-token-oauth-token-exchange</flow>
            <procedure>custom_token_exchange</procedure>
          </token-endpoint-procedures>
        </endpoint>
        <endpoint>
          <id>token-service-userinfo</id>
          <uri>/oauth/v2/oauth-userinfo</uri>
          <endpoint-kind>oauth-userinfo</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
  </profiles>
  <facilities xmlns="https://curity.se/ns/conf/base">
    <data-sources>
      <data-source>
        <id>default-datasource</id>
        <jdbc xmlns="https://curity.se/ns/ext-conf/jdbc">
          <connection-string>data:text/plain;aes,v:S.THBXcUdDd3FpUTlMcUdDeQ==.KZJw_EUbQXae05PcRDH7Fg==.2xxwBYGsv2L3YBek2IGRayItWEN6UYcudPP254u_Zrj92UstNxxhBXInFGjRoxck.fhnzI5BVjwZguQMPGbBRs7XWS8RZAI11PzIGeOcmd7A=</connection-string>
          <standard-credentials-mode>
          </standard-credentials-mode>
          <driver>org.postgresql.Driver</driver>
          <password>data:text/plain;aes,v:S.ZFY0MEJJa3lBT0x2MGhtRQ==.wHVvWIqfp9k-b2tJXtmagw==.Er9yB7Rv9moHT4IxkdJtjA==.uRmxuFKAOFxut3IXbNclTnLG0gZWsiZ8TQV5TLEajKo=</password>
          <use-for-audit>true</use-for-audit>
          <username>postgres</username>
        </jdbc>
      </data-source>
    </data-sources>
    <crypto>
      <ssl>
        <server-keystore>
          <id>default-admin-ssl-key</id>
          <keystore>data:application/p12;aes,v:S.U2R1N1RwWGd3dm4zU29UUw==._at0eqCPFjDheNm7-zVaPA==.AhOkrBtHuKzwD0J6tCeez57OefQA3VVz5TdkaqZnEjR5pw5cx4IYHIuOJpmW7iR8Z8OnHXJrtqeOCx3ajKUZv85rrks0Ijqw1O5NGfBzX9pSkA79nYOS0H4LcWxNi5U7oH7Zl7DdTkFgDC1JRaVUOeaja5dmixUwuQoy3ZjZ3YAWKmMcqy0SY41wg_eJCAnWh_srAlOLPTVLEDK-oxOA1eEBcV-13i9vL4xarxNNVS9tZ-yFpjGPC-LsmqKrrcrX2-3t-odZSsRhHu8KKX67PVkPHSJ5oJeTHS6Bu7__BIo8kC6RJ1R0N4LNldWYGWwokdq7U9VKEYtFOt-CtBELp4GOZiEvoIHOk1t1m9rbJN9Vm357g_XGNAJV5adTnJg9LHnoSznbIACSvX55JSy3saOAPWP74uXLvD0bd8rge8RNoWuxTAJPhaUoudXTXl7ZXMJRBPpmnLTVO1PcixATncKgvUDliR3nfWfsmMfccH7GiewNg48pZIOF1TEK9CnhleYe5UQM34cRl0dnhiqwSTsiGDIml9AsUBwnnB_wnMMm_LkGZ5_u1wgYkdoIcdhvij0-nPE5CWPwVKFe0kwZLbq3ZWFFj2k1RTLHX3v1Ac3_Tx6GJVxGPj1vuk-zjc_KjLepQZ82xLGaUR-IW5NJladre5rU4TCnsxNLPLROBjIgkUSMtG79KSB05KBdsLRragOFk-uKIEM5w5mwN4MYq9CBVWJMIFiZJ0CBgcQ9UPA__hRN4VEckZd06RNBqtDpI_nMlIi04izSMwX9RTWl21YtS3DjkivwQUM38XVmWh3wCOhFuwZSc0vKp9XPx2MSMs4FTh_R0iTTKWrLRaWYeClIQPGivtBOikqKGW11DDR7I5jQM42aYxPIQvgiDepbxyVzILksn3UFWoor1kBDcSohDMJktXCS1GOa5ec0d_eE3TKrVMZNpXphpxSImYcno3eULXAeSj10B2QAFo1w4EGZly-jHxowl_7Zt8RY1q1GeaxSNUKDsyb6CuKbFTNHz3J6EI_yBMzmSm3SICaxq7fp6_syB0knEeyee_pUgOr0Yfwip82oz1U8CL9zwQsuEu2Fd9Y6WApWLvJDCdM6J_EAwyClavkfiz9anBhAxCWdYQTrc9lL8Fwi6FMI6bUG5m80j1Kx5kNzzEVSjWpLC4qpnAMvCgsrJ0aHPfPrt1R0HuspqqhK1DlqIj2sjvKBXrSHfxqFDPNGU1UCKvgIgzee92Xawrsw7DzesyEg-XugUo-vtdDQF9EhmX2piTf_EfgXL3uZA3KqOPzieTVb-NpetgM2-Q0N9K4rD66u2quOv1NdTgIJRZtchwrRJW7MBrbK64ezogreuOJXF9F1osm1oM_3JCIuka92gDmB-AmMyxuyhUd8sJ5tAdMHHPpQvRxNttt-YDnFTGwhWX7XAvfYFmiQ1OeJMlypDQTLP-uNJHICH5xIGoMaqZXxBx8sJWichZV-v1jtOM7loId5zZPzEe-3n1Peeg0vmK7XknxGVZbWjqzvQPi5zPNDOPBNpTR8E242yRx9LJwwBFsdxd7OD0uv6VYbQyucgMFuDqL9xYpeExkBkXzCrLDyrKIvLn05UdMqgpWsVh7IFAGtsa48s_QxMH9XktxymH1O1ooxf-fWk0y65WcbtszRYP5drFKtgM0rMt7D2uFnG0_xfqScvy7XP9BAqQ2qohxr2xWNHXHmxZaG_g2EDM-VpCiwJ5f_31EiDvddFKPrQa0ReR-KnjotkovdtfGlYIEFVtDR9WYnS6fP67siDpdBIeOJoluIqd_UvHUDOSJtgY-2EFcU90vb_JrJ71SSIQZKIjvfESMrGJ1zUILWw49ot0FayipgwWCuwDbOueFNyR1gfQhlHwgih7UMUnDSY5l6hd4N_BGGC5tJbrXJR3x3_c8cX-uNYkJVv_VcppVzd3_er-ygzZjPThMNTX11loeyYJd28zThNzqGxXNOXslGXtY1QILQSpDHu8rovgEegkd8tvwRitFx_47vjRK7oV0Ep3215LXKdmprl5OLv_10I8Fx7HJaUmfoAm4sbC7wYOJyrgQ847twAOR3OCkZypafXp_sUGM2iyRTAdXcyKBYNNKUB7UsxslIQByS3Yd7aSh1f7FghsObnSgTteHXbBxCcZgr7uWza3B4nFf4V03aiGnNQQnHWkLJ9WdiSHuXlylHcFJNaLiIFzhG1xCW_YB5vXAaAFEhcE_d56es2_HoQqAh4rr5UW7VnzuDrL6qH8T_WpcQ02tNUqTmZrNnrL_idWb15zpWiwuFKW6WZPy-1GSTUqn3QXsDU4H3EyOCKs6Fk3cyaIDY0la3N776XOIxnf2WP5TBAgEJvgsUXsOJXoEqaCgeQlMCVx-ACsXYyFn58Vd-qPLLtvPR20YgI3L9nD0l6XeQjj1ocCReodNBCXKBf5jNCnZ0g3z2mgzfsfRpo9qaEbHRM1Ub3at-gSbFFN5bedX315OC2gUNMQlnAClpoeEPMsvb5kh5kIYZVkc5WV29GY2x_3TiESUZ24DHRIiwGUTjX5dlpTK97Ae8BxfnqcCia_soyKe7GV6gjFWne8_U1DP64gzOKsHNCAAj_B9Gw0794MRxBEa5sY8DIrI4zzIkKY4B38JBSy9XXxo91Gplbx0Fq0lc9oQfG7F_02qIsKFarGrDUiR6cJ-h6Hl4SGMo5rqaXLNxTwFJ3cq_ds-1Vy-eouMCcfLxy0wXXDQ0wc5n9DxzRNYKoTQrLYJ_GtHFcnuuRf9j2Axkm8-Nj2c4a5MKptqczKPZXdZKsnQxPvXzkerDls7q1deQyOaeVMHHWis-fhYfimIU5Y--CQuNvpMmFp9Mjz3jlJg2mPNdAUXa00BpJPc0bpKi2yGJWxeblIx4XYD6bVZY3DRy9aDqvL3rr6HKm8USlA7xu3YC8-3fSPHeGHGdInFDIH9ElKdwTshU2_T6-So7FQyv6-HjsJIJJueUCbNB_gM1tl-hcqbHspLa7K7rGIqjdAsWc2I3TU7Htm4yV9HYZYvPyP5czkKjMhIrJ7pZfQj1PpZ-aX13avN65H3ixq6Fdo_PabtVCbXSMEbcUcJWRIIehTEy5GdlENruxWXaqknlooEdNt9522dnAy0AbwlTMaA9mbYW6DL4aBTZvI75DTWNqq3ogiojvHaYx__vMS_XLXOR1dOF94g0dB_fQ4S9im-zIoHf_ksK5ShN-pA1BzTIaTH7C4dRpIz-iaEqohMo9Z3he3zkAjC9X4IHXTVjWRbD979gjLxorLycpybef3rCYke4fXBFWne_aoSG64dVxxvr5i9k2NMaaTt7Y7YNxHSHsg6PnPUg0KXa-dJWBin9k1Vp6c5hHb-OUlUTQ93cNDnOv-kQixPgnd0ISjHieVkFF2nzKqE58W_j1WhQFCCP_g7j3HK6MFpJ4bhb9qT8x0lAzBRnVLyui8b90PxebRRQC0N2o7CElQ6wXymspyswAG2VhZfdCUFHwlTWMicIvjNHvTWDYn5dddRE9kAqER2D18Y04JKRVna8kOxNkhHb2vs6r-j9QrabVJ2vvVZpj_gVyas8nxcTr8d8QU-VAS76Sk5GLe193dkDorSs0vIvDObeZWnTa3qn43n-btQJuOvcjCIAqWgShz2tCrMaCmyN.g6S2RmKcJ043dS1n4hfGXT11X5zREMXdLyK1qr6xR-8=</keystore>
        </server-keystore>
      </ssl>
      <signing-keys>
        <signing-key>
          <id>default-signing-key</id>
          <keystore>data:application/p12;aes,v:S.YlFDSjhLOEx1RnhpREs3bw==.X1PhoZrlfiXBCTRAs6Zayg==.g_GuSP-HmgnXB13T1rdkmHNw1E1nxvPLYl-vkqNSyATtFdIKi_lI0VOOYr8u9oauH8s-KzYOctrzt7EWsZf3XezJhhyyVmlzAks7vXK9bLsh8LFB02Plq0CrvIpkOdrjGweNSkia1hIb4MlWjX7eg2UC6UqmTUl18MUQ6vVC5DlvRpXyni-qvTi-ohVQk689HV-rroZH_-7gnZKEZbmEt39L46Yxks41fFVdQ1KBCfP_N93se7wQZhGorvVBQnL8tg3QdIOvRyTVbT4oK0tcJDlMXoMuAV4-crndBD4gH7H6MGNIb9AH_RlHwryHlqJzjDLQvq43Xld1YsaRr77cI8k9ZtqgZap0AbSlaB-LZXmya109ZvyO7d_vEBlLfao1zWY62_iGU0Pu7RqRLlpCz6UkrXORw1ktfWQZQcANkI6KSaLeCreW5pZC9M97V49BjcUt3Z9nzydgTtRXeBL-oWrFkmPQrcGFEOwlXdJdLlZG96TGpjHjixnysk_lNTM_Q4SpJyhBEbUD3mlH59SqPmY-UoncIpX5qPO3GvF_3HLH1pZx8aryUQazpnuLnpjc-lr0HvhHCWa4DPQLVRUcFJPQD-aLjngp1JVUN-MOOHtd1UP961FM0aZh3SuKXzIQ_IuIP3sYkGcQdnwGgrwA2IbeHUsjaOWbqq13dl8f9sL3f-7uiazsFkr33zGkrDj6fx5doybzW3dphjtd06NEWvR0cysEAuuU9l6OO7NUukwYaWMczJUFRpMPtd8BklvKKdaWDGqjv41AbUW36rQaXHbym9_gEhZiAybJPboflJ5CsZl4HRDBE3B-7NKgCzOiOoabJWsYuJQt2Q4H_3VcPB83wgazzCA5mshf3qWccUM50dxozCBIrKXjLGjH_e2k1yloXZoO8kzVHmtX8SN51jsQQiXt9CnP3iIWj6un8xCHTaqoblsSs9hqjv2NJgxqC9iD8URywzS4Zc4xKptv7-2qq1rT0VukoVWilD8mJQK15vJc9I6mz03cBZ9O91dDlQj4LHJ685J_V1LEN3LHTZQDTpsUt6eIPeGc49yo7mMFva3OlCfhVNPxMmYhz1g9gc36a6WF5FwvtEGA5Z27F6SmN-ob6zJ5tR4_cIdFdQrrfVqHikYm1pUtzFc0dF1bPYuntbBekerN61aHpNyFnmPE7gxMoHe8guDLEoiFWyrTPfespdGhZn5RvTvRnpB_RwRDwcbjHIhWEH20TQ924y20Glv48UgWz1Z4uqaMYid0lay_cyYpN-fE6bFG-L8v0hnLfPAqIZKhpsfYiAHD1yd1iCa805swufQgAoryNGOQUTeJIuSId5rGL0d3mbTplatFnliNm-4AF3ourNWpT7kcrz0sItjctsBKkzcvCHsssJRdYZM94Se80A0QoANJHXfGpcTne0veV2UhWgsuEi2gWnyszeZpsMmVk5H1BMAiYOA32M-Oa-0cAUkeFqU_6NxuZj2jSXMi086PmAwmMhC_Ar_Zvpursq5RQ8Z49CVcPNpuKySbKYBdy9BzEDd8-OslOr2VDrB7wYcOMY-Wmx-r38w5YUAZFX6Q2JwCs7X-AAc3pvejkiotLjTd7zDpaz1AFBUu19dFL5jkWn7r7QdAr6u4w3ppsfq4oBXYTbEk9kdTFwhzqwr02t3K24FWSmcq7MViwltJdRQj3lBQv-h4fiVphRL9V9Drqpef88qehI7TguaxiZOxAZOf8Vsb1UegA0IiGRObWpTPGzoaFYa_9BV8mk_G-lCwbdY_jeU8r6ANEEr5ioi2dMm-cCH0hghFY01rR32RJSfcYqPsEIxcuAUXg2tcedwhLnS8EcqAxJnO7AutSfFsRwEfQud_koCoqmbvc2wKlRaxA0wny_OB7AzV_cXwahgFpVE9S3mmK8CjMBwWeXXfJvccx7O-oDCYXWnpDwH8bBRwMnSvXh2bhpCAAC3GFf4lYXLu6akPUziyARvCma3Dj7qMK_U_D5_cW6-iGvp_hprIOzXO60nPt2YZzG3GrB2qUBPrJ1eF7fJnclygdvY_OI1JZF3kEfs62WVg4lHoIiVZ-3u1oJu8m6mOhKulx2y6uKoJ1BEgzReP_KuF0slVxYJesx5vdydKmRweWCye_dzH9WwyLhsLFE6JCOhmNaGuzRaSep__AXq8Lz26rvNRtuUZ3tbo6Q73BzOL6McJHj_ZL9_CEX_Am6mcZS6BakTXLSGADTa6sdICNte_uTzRTgEy4Lia0Ty2CK8FK8XdG9GECXVden3kw5JY3Q3N6FWwQIXu0J6UUU0ecbUe5K0wci1gMQNYDKN9uUe7o08GqTM2s8uukIb98-bjs8hvlyfvt2q_h2FzNLpU8AWKLcdGdKIOi5a_3V-uZCy0mmxPFOfpKutQ42wfb1GMhAbRf1RJ6CzKCDTiwccBIaTc-3osx6hE19WiEwoGQ0M28nJIrGB-SY0enbu8JO7REmH6gFn9OcPKlP2Qynqn8kMIbw3VH6yYrKOsZdGU4l_Q0Ns3TBTBJI1e0smiB5GHEv09PdD16LcUYxgBf3dbCKs5GIppwPoLPIEND-CF-Mj9vXx2WWpZraRo28XQusid7q2oym79Sy1ud6F5Oytw-sasvhPS7Gx7MonZOaIAiFqe4pma9fQyz_vqiTo6tPxb4I1dqxp1BrRbMNqtDNNpwlK2f4z32d7gkhJ6M6ZE20Kgn-IwKtTsDCs1RHOfyPhfT1FhtNIzPd37h510T8JRx0430MVuojQAR4TiNbu12pXNfoiquhqumy3CpxLLTAaDK6elHkKsR5e82jhZdViFSaubycDNZP62nU6Kk_EJFqoroHERaSR0g_yC6t2LaLS8IJm9E_Pvxh8aXCjbnkQIkuQUZaYvTafQwfM-M_Hpq3saTpZwR69fkrDFsAmj8zS74ZtaYBtZ5r8iqgtL9YSXOZOvLwsZTm7OabM8nr3VDViHyoYPSJyBvhg2pxgOZNQDByH2LVVhaEx7iGvS7v9rXmZIjndKtS-LK9yjgRbib49gJxT-Z2MMZkAqrCBqJz77PzGVAQsQzZ6MNopWh2_izEVcQJEQWUL2UvbqOqRQt2sCpWnqxI9tkmuBnZxEvKdOXBcCMZzxmBm2sQEzYXqc5XBr2Zn9xPUjN1hehX0xbf2O1tuwZ_5iEhjUHoIq9mrrKlJHb5jPkzG6qTzTFruuJ2KozvqMXELb9fqDBwFzizTafSfOm-vN7c7pNz8a-o5AJXxI5GdSfYjzBFTPYwIQBNcOpq2lAZqjXK_ixHsTuwAlx-KWZ-9xwjDA_C1835tUANe54z3aY-z9WJX76DNVTsW_ce83JEPMYQuoJZXPnXbHiZ-KLpLgoLfBtTLeW9yp7KFgicE4wKArvRNfFiaG7-nvR7ILqt0IgqsxHqqYI1FFr72e5umyRNi9vf5xPz1Wz1lIPcDYGWBHfF4e3IzTTdxz0WRuJzI3iQxbntae3nL_4FiAKBsePRWdNHwPmzp3RpnOmo7Kfu1lr7NGzFc7fNjfaHvecbuXngPEvmvi_erhSUyA6tsSXHUmqCY2Vpa7087jq7cVVoCkjS947PhzEgoFiNsPdBG4NiFIZ61CO4wfv7FnTZ4dlslxJgVXglz3-C__hr2-GEMPJPy1YojpAhHMej4_mkROtHfr.wJ0GPoWOCV4Ng31orxyWJ7BjW42ifRiJY0eGfcLL5ko=</keystore>
        </signing-key>
      </signing-keys>
      <signature-verification-keys>
        <signature-verification-key>
          <id>default-signature-verification-key</id>
          <keystore>data:application/pem;aes,v:S.Slg0TmVueDlOZHhFWVRiRQ==.A64o1_CEDZ8YWbj5LTVT8g==.9Po00S13RPgSCyBRCojR1Daj5AGeJzB4LQjqN9SuJJkicS04t3BplnsAzBQf4skQfEFrxE_cJzAOQZM_7e-RlaiSwS0ryoF4hNHEjrKaI9RkiZX1YqvDvheienwVdztNzkPdD9C-fnBv9TpfvrLiyRd7w3QeesxX_qCu_ypbCKa2SjHnFds7HbEwyDsOroW7RkGdVD-xZaclzlRJWAjo-4Fohp5TZ-9bxvmCu0MiUKTZG_dSGylG9ymAlxFBWJ-JmMiw6WS4FyFvVTblww-aGO6aW2cWecEl3DGZDzpdRvQlAHhz-VXHLmrHBVdKq4xQxLCQYFJLefxfQvZYuD0I5y1zxQI2kzMlSu7bXd-lLMVAbt_5QwiRWSgZT8uPIk2FeCT7dI4J-3i8rpjlxuZf3B8Uh0pry2TQ8QAuqT7Zx4-mZx6brOJdtiVZXvmRDTaB7QI0dbnwfqH5VF0kQ_iQZu9-zGLHJwmb3G9t6f7TAKwfXRu504EAc9BZadb7VgKp9f2PCW5Naz4ikkBFMhk6U66itN0yB-Tkf7zwi0nAb1ZjlFReyxIfDuNAhOnFkRQt5DR-Bvyc4oEexbzey2HxNyjm5aYK4xTqD0vJk6sDm0xSwu5YnCK1ilBkCOPkQ4N5X2Xu6BjwcHO8pUaTctINBdyavFD3HreCxLZZ4wPGxGd-OQ-xvcLn9SI2mP_zOyr5bbB4W68bUYKRZrA-YEH5YKd2mFChGD7TtfTBoiYc9ioNj8i8R0lE7h4wZRa3CExxKQVzJJwarZWZHNmqc314Yh-2oFgpQJTjY3UiW5n70-BaaDjyb9N6NDqw6nssQL23eRVZr-ce1njUkCM6AEckHPiIAK6trZmDV1LG8Li2zGGg2C8M2-E91M5KuNDPc7XHoZw53oFZb0gzgxJLJNS1CaI0oudEHJt6IrJ9gC8AMQHvvu_hSbsCR3om2XGWAXFGVFHhxjiG_gmzblNGm989N5it9TTZMAEYYDWWUN5bLZiDY8eD4AYjmpyqQabraCyJZYafuRO4qmBN-bCVb2Qd4a0jc35jmcM2FYBAz318ojvEKXzhX_UTS33oblVSHOVR3aOal-rrTN_CUTEwYYyzGb5m8JlAm66D32eUbRPo6ddDc0129m596hWww9kQFLxPPljVTS3v8IdRxw4b0h_gFh7c0KrEBNbiTml9wjCcwE3rO6fiXf3ZRkUqpBe3h_RdYUsZCXZcKpK1ODgKteaAg9Tr809C9upESqmp_IhLrpLnpkiBc8RTKKdzaF8gku46JLi7Vd7_qGYqhNVjv76CXirmoCfFc3nAmPgwiDytqd09i4qSYpQN01XIfEP-GokDZ8FUQYjfvpjBRvFC5_YqVQPvf_MQDyqAR2Xp6Miz8qS27V61kvXKDE4hYB0pEDWjQvHkKD2VB3oK5I06zk1HD8kLJGJV9vXLQq04I_BszQDDbYtdakH8Q4DMqntEWH4snoiKkygJn2ibu-SSowDDzDHUoZnedadX6JNZp_lm-Ww7Pf9Nez0UXK00fbgNS-pD2SRRWYPPktePJJCO7s671k-LZ9d0pJcUjhBubztafPwqbJ4KSfvVGc41vs_vWzUeVUsv_c6smSwtp-ZL8Y37JOpKj2s4WJOJ9qkOZtnEB-nOjTFY5TfMMFUbeSauEX-F._8M607zhaUptSRUeQ13IaNn49HRCZQKHUnxQs3FzQGY=</keystore>
        </signature-verification-key>
      </signature-verification-keys>
    </crypto>
    <caching-services>
      <default-caching-service>
        <data-source>default-datasource</data-source>
      </default-caching-service>
    </caching-services>
  </facilities>
  <processing xmlns="https://curity.se/ns/conf/base">
    <license-key></license-key>
    <procedures>
      <token-procedure>
        <id>custom_token_exchange</id>
        <flow>oauth-token-oauth-token-exchange</flow>
        <script>LyoqCiAqIEBwYXJhbSB7c2UuY3VyaXR5LmlkZW50aXR5c2VydmVyLnByb2NlZHVyZXMuY29udGV4dC5PQXV0aFRva2VuRXhjaGFuZ2VVbkluaXRpYWxpemVkUHJvY2VkdXJlQ29udGV4dH0gY29udGV4dAogKi8KZnVuY3Rpb24gcmVzdWx0KGNvbnRleHQpIHsKICAKICB2YXIgcHJlc2VudGVkU3ViamVjdFRva2VuID0gY29udGV4dC5nZXRQcmVzZW50ZWRTdWJqZWN0VG9rZW4oKTsKICB2YXIgcHJlc2VudGVkRGVsZWdhdGlvbiA9IGNvbnRleHQuZ2V0UHJlc2VudGVkU3ViamVjdFRva2VuRGVsZWdhdGlvbigpOwogIHZhciBleHBpcnlTZWNvbmRzID0gMTAwOwoKICBpZiAocHJlc2VudGVkU3ViamVjdFRva2VuID09PSBudWxsKSB7CiAgICB0aHJvdyBleGNlcHRpb25GYWN0b3J5LmJhZFJlcXVlc3RFeGNlcHRpb24oJ2ludmFsaWRfcmVxdWVzdCcsICdJbnZhbGlkIHN1YmplY3RfdG9rZW4nKTsKICB9CgogIC8vIEltcGxlbWVudCBjdXN0b20gdG9rZW4gZXhjaGFuZ2UgbG9naWMgZm9yIGF1dGhvcml6ZWQgY2xpZW50cwogIGlmIChjb250ZXh0LmNsaWVudC5wcm9wZXJ0aWVzWydjdXN0b21fdG9rZW5fZXhjaGFuZ2UnXSA9PSAndHJ1ZScpIHsKCiAgICB2YXIgcmVxdWVzdGVkU2NvcGUgPSBjb250ZXh0LnJlcXVlc3QuZ2V0Rm9ybVBhcmFtZXRlcignc2NvcGUnKTsKICAgIGlmIChyZXF1ZXN0ZWRTY29wZSA9PT0gbnVsbCkgewogICAgICB0aHJvdyBleGNlcHRpb25GYWN0b3J5LmJhZFJlcXVlc3RFeGNlcHRpb24oJ2ludmFsaWRfcmVxdWVzdCcsICdObyBzY29wZSBzcGVjaWZpZWQnKTsKICAgIH0KCiAgICB2YXIgcmVxdWVzdGVkQXVkaWVuY2UgPSBjb250ZXh0LnJlcXVlc3QuZ2V0Rm9ybVBhcmFtZXRlcignYXVkaWVuY2UnKTsKICAgIGlmIChyZXF1ZXN0ZWRBdWRpZW5jZSA9PT0gbnVsbCkgewogICAgICB0aHJvdyBleGNlcHRpb25GYWN0b3J5LmJhZFJlcXVlc3RFeGNlcHRpb24oJ2ludmFsaWRfcmVxdWVzdCcsICdObyBhdWRpZW5jZSBjbGFpbSBzcGVjaWZpZWQnKTsKICAgIH0KCiAgICB2YXIgdHJhbnNhY3Rpb25JZCA9IGNvbnRleHQucmVxdWVzdC5nZXRGb3JtUGFyYW1ldGVyKCd0cmFuc2FjdGlvbl9pZCcpOwogICAgdmFyIGV2ZW50UGF5bG9hZEhhc2ggPSBjb250ZXh0LnJlcXVlc3QuZ2V0Rm9ybVBhcmFtZXRlcignZXZlbnRfcGF5bG9hZF9oYXNoJyk7CgogICAgdmFyIG5vdyA9IG5ldyBEYXRlKCk7CiAgICB2YXIgZnV0dXJlID0gbmV3IERhdGUoKTsKICAgIGZ1dHVyZS5zZXRGdWxsWWVhcihub3cuZ2V0RnVsbFllYXIoKSArIDEpOwogICAgdmFyIGV4cGlyeVNlY29uZHMgPSBNYXRoLnJvdW5kKGZ1dHVyZS5nZXRUaW1lKCkgLyAxMDAwKTsKCiAgICB2YXIgYXVkaWVuY2VzID0gW3JlcXVlc3RlZEF1ZGllbmNlXTsKICAgIHZhciBzY29wZXMgPSByZXF1ZXN0ZWRTY29wZS5zcGxpdCgnICcpOwogICAgdmFyIGZ1bGxDb250ZXh0ID0gY29udGV4dC5nZXRJbml0aWFsaXplZENvbnRleHQoCiAgICAgICAgY29udGV4dC5zdWJqZWN0QXR0cmlidXRlcygpLAogICAgICAgIGNvbnRleHQuY29udGV4dEF0dHJpYnV0ZXMoKSwKICAgICAgICBhdWRpZW5jZXMsCiAgICAgICAgc2NvcGVzCiAgICApOwoKICAgIHByZXNlbnRlZFN1YmplY3RUb2tlbi5hdWQgPSByZXF1ZXN0ZWRBdWRpZW5jZTsKICAgIHByZXNlbnRlZFN1YmplY3RUb2tlbi5zY29wZSA9IHJlcXVlc3RlZFNjb3BlOwogICAgcHJlc2VudGVkU3ViamVjdFRva2VuLmV4cCA9IGV4cGlyeVNlY29uZHM7CiAgICBpZiAodHJhbnNhY3Rpb25JZCkgewogICAgICAgIHByZXNlbnRlZFN1YmplY3RUb2tlbi50cmFuc2FjdGlvbl9pZCA9IHRyYW5zYWN0aW9uSWQ7CiAgICB9CiAgICBpZiAoZXZlbnRQYXlsb2FkSGFzaCkgewogICAgICAgIHByZXNlbnRlZFN1YmplY3RUb2tlbi5ldmVudF9wYXlsb2FkX2hhc2ggPSBldmVudFBheWxvYWRIYXNoOwogICAgfQogIH0KCiAgdmFyIGlzc3VlZEFjY2Vzc1Rva2VuID0gZnVsbENvbnRleHQKICAgIC5nZXREZWZhdWx0QWNjZXNzVG9rZW5Kd3RJc3N1ZXIoKQogICAgLmlzc3VlKHByZXNlbnRlZFN1YmplY3RUb2tlbiwgcHJlc2VudGVkRGVsZWdhdGlvbik7CgogIHJldHVybiB7CiAgICBzY29wZTogcHJlc2VudGVkU3ViamVjdFRva2VuLnNjb3BlLAogICAgY2xhaW1zOiBwcmVzZW50ZWRTdWJqZWN0VG9rZW4uY2xhaW1zLAogICAgYWNjZXNzX3Rva2VuOiBpc3N1ZWRBY2Nlc3NUb2tlbiwKICAgIHRva2VuX3R5cGU6ICdiZWFyZXInLAogICAgZXhwaXJlc19pbjogc2Vjb25kc1VudGlsKHByZXNlbnRlZFN1YmplY3RUb2tlbi5leHApLAogICAgaXNzdWVkX3Rva2VuX3R5cGU6ICd1cm46aWV0ZjpwYXJhbXM6b2F1dGg6dG9rZW4tdHlwZTphY2Nlc3NfdG9rZW4nLAogIH07Cn0=</script>
      </token-procedure>
    </procedures>
    <account-managers>
      <account-manager>
        <id>default-account-manager</id>
        <enable-registration>
          <account-verification-method>no-verification</account-verification-method>
        </enable-registration>
        <account-data-source>default-datasource</account-data-source>
      </account-manager>
    </account-managers>
    <credential-managers>
      <credential-manager>
        <id>default-credential-manager</id>
        <Sha2WithSha256>
        </Sha2WithSha256>
        <data-source-backed>
          <data-source-id>default-datasource</data-source-id>
        </data-source-backed>
      </credential-manager>
    </credential-managers>
  </processing>
  <nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm">
    <write-default>permit</write-default>
    <groups>
      <group>
        <name>admin</name>
        <user-name>admin</user-name>
      </group>
    </groups>
    <rule-list>
      <name>admin</name>
      <group>admin</group>
      <rule>
        <name>any-access</name>
        <action>permit</action>
      </rule>
    </rule-list>
    <rule-list>
      <name>any-group</name>
      <group>*</group>
      <rule>
        <name>tailf-aaa-authentication</name>
        <module-name>tailf-aaa</module-name>
        <path>/aaa/authentication/users/user[name='$USER']</path>
        <access-operations>read update</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-aaa-user</name>
        <module-name>tailf-aaa</module-name>
        <path>/user[name='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-webui-user</name>
        <module-name>tailf-webui</module-name>
        <path>/webui/data-stores/user-profile[username='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
    </rule-list>
  </nacm>
  <aaa xmlns="http://tail-f.com/ns/aaa/1.1">
    <authentication>
      <users>
        <user>
          <name>admin</name>
          <uid>0</uid>
          <gid>0</gid>
          <password>$5$m7y0GfCi$uuWsjLks5Wf8k2oPKy09h1MffQeqXYg6R7JdhT.eR68</password>
          <ssh_keydir>/opt/idsvr/home/admin/.ssh</ssh_keydir>
          <homedir>/opt/idsvr/home/admin</homedir>
        </user>
      </users>
    </authentication>
    <ios>
      <level>
        <nr>0</nr>
        <prompt>\h> </prompt>
      </level>
      <level>
        <nr>15</nr>
        <prompt>\h# </prompt>
      </level>
      <privilege>
        <mode>exec</mode>
        <level>
          <nr>0</nr>
          <command>
            <name>action</name>
          </command>
          <command>
            <name>autowizard</name>
          </command>
          <command>
            <name>enable</name>
          </command>
          <command>
            <name>exit</name>
          </command>
          <command>
            <name>help</name>
          </command>
          <command>
            <name>startup</name>
          </command>
        </level>
        <level>
          <nr>15</nr>
          <command>
            <name>configure</name>
          </command>
        </level>
      </privilege>
    </ios>
  </aaa>
</config>