<config xmlns="http://tail-f.com/ns/config/1.0">
  <environments xmlns="https://curity.se/ns/conf/base">
    <environment>
      <base-url>http://localhost:8443</base-url>
      <admin-service>
        <http>
          <ssl-server-keystore>default-admin-ssl-key</ssl-server-keystore>
          <web-ui>
          </web-ui>
          <restconf>
          </restconf>
        </http>
      </admin-service>
      <services>
        <zones>
          <default-zone>
            <symmetric-key>data:text/plain;aes,v:S.S3lPWlRCT2NoenJ6MnRsQQ==.QIhoPlCG-oXw4rcxw10RmQ==.QRAXrM9EFTSO83Op8aj7m-PBEIWPycPwXxdQPvqeAg2mgcKPBpJt465zY1CSiRX2w1glG3-7o8kpJTxaf_dZt84HuB0vrZdIvyfVT1T9exU=.cghOAUXNxqDzT_5YMYKWwx6tO2yuwwZHCKFvC9VrhjU=</symmetric-key>
          </default-zone>
        </zones>
        <service-role>
          <id>default</id>
          <protocol>http</protocol>
          <endpoints>authentication-service-anonymous</endpoints>
          <endpoints>authentication-service-authentication</endpoints>
          <endpoints>authentication-service-registration</endpoints>
          <endpoints>token-service-anonymous</endpoints>
          <endpoints>token-service-assisted-token</endpoints>
          <endpoints>token-service-authorize</endpoints>
          <endpoints>token-service-introspect</endpoints>
          <endpoints>token-service-revoke</endpoints>
          <endpoints>token-service-session</endpoints>
          <endpoints>token-service-token</endpoints>
          <endpoints>token-service-userinfo</endpoints>
        </service-role>
      </services>
    </environment>
  </environments>
  <profiles xmlns="https://curity.se/ns/conf/base">
    <profile>
      <id>authentication-service</id>
      <type xmlns:auth="https://curity.se/ns/conf/profile/authentication">auth:authentication-service</type>
      <settings>
        <authentication-service xmlns="https://curity.se/ns/conf/profile/authentication">
          <authenticators>
            <authenticator>
              <id>UsernamePassword</id>
              <html-form xmlns="https://curity.se/ns/conf/authenticators/html-form">
                <account-manager>default-account-manager</account-manager>
                <credential-manager>default-credential-manager</credential-manager>
              </html-form>
            </authenticator>
          </authenticators>
          <protocols>
            <protocol>
              <id>default-simple-protocol</id>
              <simple-api/>
            </protocol>
          </protocols>
        </authentication-service>
      </settings>
      <endpoints>
        <endpoint>
          <id>authentication-service-anonymous</id>
          <uri>/authn/anonymous</uri>
          <endpoint-kind>auth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-authentication</id>
          <uri>/authn/authentication</uri>
          <endpoint-kind>auth-authentication</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-registration</id>
          <uri>/authn/registration</uri>
          <endpoint-kind>auth-registration</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
    <profile>
      <id>token-service</id>
      <type xmlns:as="https://curity.se/ns/conf/profile/oauth">as:oauth-service</type>
      <expose-detailed-error-messages/>
      <settings>
        <authorization-server xmlns="https://curity.se/ns/conf/profile/oauth">
          <authentication-service>
            <authentication-profile>authentication-service</authentication-profile>
          </authentication-service>
          <client-capabilities>
            <code>
            </code>
            <implicit/>
            <resource-owner-password-credentials>
              <credential-manager>default-credential-manager</credential-manager>
            </resource-owner-password-credentials>
            <client-credentials/>
            <introspection/>
            <token-exchange/>
            <assisted-token>
            </assisted-token>
          </client-capabilities>
          <scopes>
            <scope>
              <id>address</id>
              <description>OpenId Connect address scope</description>
              <claims>address</claims>
            </scope>
            <scope>
              <id>email</id>
              <description>OpenId Connect email scope</description>
              <claims>email</claims>
              <claims>email_verified</claims>
            </scope>
            <scope>
              <id>openid</id>
              <description>Standard OpenID Connect scope</description>
            </scope>
            <scope>
              <id>orders</id>
            </scope>
            <scope>
              <id>phone</id>
              <description>OpenId Connect phone scope</description>
              <claims>phone_number</claims>
              <claims>phone_number_verified</claims>
            </scope>
            <scope>
              <id>profile</id>
              <description>OpenId Connect profile scope</description>
              <claims>birthdate</claims>
              <claims>family_name</claims>
              <claims>gender</claims>
              <claims>given_name</claims>
              <claims>locale</claims>
              <claims>middle_name</claims>
              <claims>name</claims>
              <claims>nickname</claims>
              <claims>picture</claims>
              <claims>preferred_username</claims>
              <claims>profile</claims>
              <claims>updated_at</claims>
              <claims>website</claims>
              <claims>zoneinfo</claims>
            </scope>
            <scope>
              <id>trigger_payments</id>
            </scope>
          </scopes>
          <claims>
            <claim>
              <name>address</name>
              <description>OpenID Connect address claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>birthdate</name>
              <description>OpenID Connect birthdate claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email</name>
              <description>OpenID Connect email claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email_verified</name>
              <description>OpenID Connect email_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>family_name</name>
              <description>OpenID Connect family_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>gender</name>
              <description>OpenID Connect gender claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>given_name</name>
              <description>OpenID Connect given_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>locale</name>
              <description>OpenID Connect locale claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>middle_name</name>
              <description>OpenID Connect middle_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>name</name>
              <description>OpenID Connect name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>nickname</name>
              <description>OpenID Connect nickname claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number</name>
              <description>OpenID Connect phone_number claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number_verified</name>
              <description>OpenID Connect phone_number_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>picture</name>
              <description>OpenID Connect picture claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>preferred_username</name>
              <description>OpenID Connect preferred_username claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>profile</name>
              <description>OpenID Connect profile claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>updated_at</name>
              <description>OpenID Connect updated_at claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>website</name>
              <description>OpenID Connect website claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>zoneinfo</name>
              <description>OpenID Connect zoneinfo claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claims-value-provider>
              <id>account-manager-claims-provider</id>
              <account-manager-claims-provider xmlns="https://curity.se/ns/ext-conf/account-manager-claims-provider">
                <account-manager>
                  <id>default-account-manager</id>
                </account-manager>
              </account-manager-claims-provider>
            </claims-value-provider>
            <claims-mappers>
              <claims-mapper>
                <id>default</id>
                <id_token>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </id_token>
                <userinfo>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </userinfo>
              </claims-mapper>
              <default-claims-mapper>default</default-claims-mapper>
            </claims-mappers>
          </claims>
          <openid-connect>
            <expose-metadata>
            </expose-metadata>
          </openid-connect>
          <client-store>
            <config-backed>
              <client>
                <id>console-client</id>
                <client-name>console-client</client-name>
                <no-authentication>true</no-authentication>
                <redirect-uris>http://localhost:8000</redirect-uris>
                <proof-key>
                  <require-proof-key>true</require-proof-key>
                </proof-key>
                <refresh-token-ttl>disabled</refresh-token-ttl>
                <audience>api.example.com</audience>
                <scope>openid</scope>
                <scope>orders</scope>
                <scope>profile</scope>
                <scope>trigger_payments</scope>
                <user-authentication>
                </user-authentication>
                <capabilities>
                  <code>
                  </code>
                </capabilities>
                <use-pairwise-subject-identifiers>
                  <sector-identifier>console-client</sector-identifier>
                </use-pairwise-subject-identifiers>
                <validate-port-on-loopback-interfaces>true</validate-port-on-loopback-interfaces>
              </client>
              <client>
                <id>introspect-client</id>
                <client-name>introspect-client</client-name>
                <secret>$5$B4U/JTO4ZH7bgcJB$ut5slpp4Xk7lMw2LIDxMXmdctcLiwnhqmMWhTtf8sKC</secret>
                <capabilities>
                  <introspection/>
                </capabilities>
                <use-pairwise-subject-identifiers>
                  <sector-identifier>introspect-client</sector-identifier>
                </use-pairwise-subject-identifiers>
              </client>
              <client>
                <id>orders-api-client</id>
                <client-name>orders-api-client</client-name>
                <secret>$5$Jivs3cNjoJJaw.vZ$AGmVCr5K0MFxwtomI32cczZtkD2VO9eg.3umg.kSdZ1</secret>
                <audience>api.example.com</audience>
                <scope>orders</scope>
                <scope>trigger_payments</scope>
                <capabilities>
                  <token-exchange/>
                </capabilities>
                <use-pairwise-subject-identifiers>
                  <sector-identifier>orders-api-client</sector-identifier>
                </use-pairwise-subject-identifiers>
                <properties>
                  <property>
                    <key>custom_jwt_token_exchange</key>
                    <value>true</value>
                  </property>
                </properties>
              </client>
            </config-backed>
          </client-store>
        </authorization-server>
      </settings>
      <endpoints>
        <endpoint>
          <id>token-service-anonymous</id>
          <uri>/oauth/v2/oauth-anonymous</uri>
          <endpoint-kind>oauth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-assisted-token</id>
          <uri>/oauth/v2/oauth-assisted-token</uri>
          <endpoint-kind>oauth-assisted-token</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-authorize</id>
          <uri>/oauth/v2/oauth-authorize</uri>
          <endpoint-kind>oauth-authorize</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-introspect</id>
          <uri>/oauth/v2/oauth-introspect</uri>
          <endpoint-kind>oauth-introspect</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-revoke</id>
          <uri>/oauth/v2/oauth-revoke</uri>
          <endpoint-kind>oauth-revoke</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-session</id>
          <uri>/oauth/v2/oauth-session</uri>
          <endpoint-kind>oauth-session</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-token</id>
          <uri>/oauth/v2/oauth-token</uri>
          <endpoint-kind>oauth-token</endpoint-kind>
          <token-endpoint-procedures>
            <flow>oauth-token-token-exchange</flow>
            <procedure>custom</procedure>
          </token-endpoint-procedures>
        </endpoint>
        <endpoint>
          <id>token-service-userinfo</id>
          <uri>/oauth/v2/oauth-userinfo</uri>
          <endpoint-kind>oauth-userinfo</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
  </profiles>
  <facilities xmlns="https://curity.se/ns/conf/base">
    <data-sources>
      <data-source>
        <id>default-datasource</id>
        <jdbc xmlns="https://curity.se/ns/ext-conf/jdbc">
          <connection-string>data:text/plain;aes,v:S.bjJOcGJzNDg2Y1I1TmJkbQ==.rRf2uLseI-EldLt3U_adrw==.AS36u5WkqFRMca2ffdaZRXohq6ZGYyLQ3wzXPn_EC0QiZbMHaZAUbPTwfs24fTQK.bHbI9ZZXS-WROE9Pr0avd3oTIVDtGAluE_dBE2c8ndM=</connection-string>
          <connection-timeout>30000</connection-timeout>
          <driver>org.postgresql.Driver</driver>
          <idle-timeout>600000</idle-timeout>
          <max-lifetime>1800000</max-lifetime>
          <max-pool-size>20</max-pool-size>
          <min-idle-pool-size>10</min-idle-pool-size>
          <password>data:text/plain;aes,v:S.UWZDRWlUc2JwSzZlUGcyUg==.YTS0s_NKxdSPPKgDLw_DLQ==.I98HZviW3BGNQjAqtX_idg==.jHhB0f4eyFGCrMBJTnYQwt8VHJEXEhBHg6wc3efZWV8=</password>
          <use-for-audit>true</use-for-audit>
          <username>postgres</username>
        </jdbc>
      </data-source>
    </data-sources>
    <crypto>
      <ssl>
        <server-keystore>
          <id>default-admin-ssl-key</id>
          <keystore>data:application/p12;aes,v:S.MDUyR3FEaUY5RFZneWl2bA==.qZj98leDOgHVbyCarPjHgg==.bOlodKIn7F555NzLe0mUFjqb_n75mLV4b2ayNYcRHMjYCfdN0buJ_UbYJZeK14cIGbk6uoa_1Kw32izuWxOzhjogy7XYnKH3J1GTiV79gTWx19-HP0Gv1q2aSO4pilYq9JnjY_Br3hGRpCswekIUIr850YXDcTSKgqY9R04Mf_FI6YeC5-mmneSEM8zuVUFI8Cn6ULZgXyWK0amlMhVKNs_XNF-bvsZvW0r3LhPiqTSsz3wZBv90bXr83Air0sq9CBOVIut1AXbUdmJJ4sZMKqup3Lxp0tgk3ctPXmT1PDp1Hmk2TxssfMjz8h_aDvaV74JT56Y8pFVciSdAykTcFAGnijEPFQ8Gf6Z9I9DjgGHSidG7GCViMyuVjmQdnaSCoqOX3hs_LFweoCOaRWsgvUPRvAug1vyRz1nNBabvKzyzWN_NO1xhK7MqYiy6EqwJxkV9VYPAsah6TbIr23NOWarAr7SAc5C7WiA8H4OfBTdYlcWJVVJ3Xd1w6CrdV0pgrod5ccHKxWCp5TYFghn2xjsMniFbaRyYpqm6jby2h2eKhaZhsdiVsnAQDwmmqRscLQTqTvjeo468IoFZcwx5NCThizLoIfmtvxMBMrbiZ38o6u-u5gXwbyuxI2txJwDt99u3LaujwtDKH3oURpPfVzqWJtn74ZIZVQTa-U6NXBmcJvoYoCr1Wg8IYucf-ObQfAuHzVfF6IoMH4jLtS__w8HFyB2uLU7YHONWzyW7Z15sM-8uprF9iTYRiAQy1T0jNfnWGjlZQVp6pZ12SoCqXavhwqLf-ixiJT4wAyucdTm1duZFxm5Imo69bWYw4KKRKGESplegUnLxKdCEFdY3MH0HSQI6MHo6fXG4IXItdywRHq29jRJ4qwsFk855XjuEavce4Xbx4tbwUk5Hw6Q5n1fM4La8aImY4l19-d0Z6Rtw_O4OnpjFT13lSzHS6IBu9npoVvyvi6J2RBGs--cpp6VhW6GX4n_pRqZW7g-uWdbW-P1w_JbGol8H3kjFi80-rBoepz_wYuZgVmq4iHqhE5lM8lwZyQ8YNB2js2McMKz3qPq-hyt0HLTkteJPfTSBClg4CiG4kh5-dz5KG7AJaAB-pWVHDJmlstTgYkEsmXmJ4G3VjJ1RT4CwsEVS9W2SPmgN7ieNFxSioJqQ4P6RiK36nAW8CT1QvbE6OVtIO6MmgjxKWgTduAU5D9DC5_88StFmIpQB8NcK3PMuUZBSkYDWnyi165wR3qxLNOsEdBHHlRT2iHpXToIfCrwTlLZ-QSwHJGGSqRbVhSHGGmGtArpu7acjfvKWVKat-6fti3rrS-XzkVU1R51GCSQusBeak4vuH-rZNyisIzNC8oURxaRjXo5cibOhdXqXakzjWlgDzsOqRC1N-cG5tAAo6cH02KdNAKKFtdR9IABl9gMKndF6kek1_BAnetaIn-5srYabVFbyRP-jCkqWv8-FjoQiOMuAxFeTicW-mJ6osydriFncjKEBXi3TQzK0a9MrCKwOjUiob7YRQqWBB3CvQuK2pIyPbKdrnfG6WAZlPRCAEw5Xkjm09PQw9ZgrYnnVDY6DlVGq86R79vlw1EHmUMor-e2h5pkpCEvqOi1eOTeihXEyrGeB6Abjrvy2JZJUQQHCb59Ow4-zIR0wiU0EP8x5wl1dHDy44JNt7OCPW9OUpikhNbyINrul8wEfYTSuYtGT24mIQJk7pmd22FLwuV-LU3uD7zsUahZbuJO0Jok0aaGDlMPM2lKehgEPzMPpeedkREy68CdebatMmuIXf47oUsgh9ZKQOcNHV6m_XICAszcQbhCGuKR9lRD9-q3tbe56kpXG8XbxGTo91bykdz6UwXqQc9CNrA4NPHX5WX4u66VnUfUjVxXk-EGKyoCVUUci_4wlyVSGynD0DoAgIPGYrI6NxR0r1QiO-B-8bYHJugLW96ZdInSPGR5O8sU7QqMovGpxnMmhua6l8aGaEPAZDkw0TfB9MOzVfryztQJA6_AcofANFjTJXo7ByGw7-nS3MesCX0VLRl4dhM5cuq-ta1qdlFBMKAMHF9tQnpMYhHorombpOmCsv3yKqwNbBvtDkT-9Dpyz9ZA7lNpXaYH5F8jchy6jE-Qd6nsJOGd5EA9tDuLLQptwr8OcnVOcfKAGiUrdBmXBrGW2rueUjr5FzTlAoRmeLVOnTB-zeZs-EPdeZTs47CyXtlMu4rTpU94uJwle4Oosar4GSSGzEnoTU64NpHgruHfhac8Q4WB92HAAPVF8hU0VTIHYcjtsuIDeTxs16F_899pm2amyAx53gllX3RLtLxKPD_fctZPTGrjdhy6JdHRJwqEaiSHmqqm9YYEx0IFVuqs5HgvJIGgfJrV6G-Qqa3Hp3usOOonniRWO6ilOCyIA-1IrdbhCP_2NqgKUMhS9uzNThw0HjhQAbVNAQYM-Cuhaookv9hesMWudVO3tDlVGEYJxOx_3UXBZHqI2bJ18MVJi7c7McLu2x50dllqNVpACNgsPIiBbxuOFWlckeU9Krrf_jWULVWSu0EF1WsTiw8YsU4tni5gwKrbcDFBaWxotQDvMXJNbDe5gYKFHf8rFeKaynYc0I0KzFzWGnSrAm38wQN9-AfzOoOZTDKJkxs_loDgh8axt42mbUgaaD_cGQLD74mnwlQha0oS-cBFXA6gvz8dHdEap26VQVGUZ6C-xKZGwfPY_NNE4mZjuNTPEVmHn2PWsRGRqn_1Gci2dcX1nB7GRiAXyZrrzRBsl-CYR5me4AGaybAVnF2RYlMhKXjlt6ENfv_kOJJrnIzAUS3YmluGp4JVx9j_2tTJoxSjiL1YkDlzrFK5DrVaP8BfXkDztJ6IgRFKb99kI-f1evnVUUjQ2T6sWO1tdfN0tOnMj_f_673VKJTGJCZH5xvdbhdy-pAIMJGLQWeLdkDO_jJLXxHdSBWwmjMs2SUwmL50BU1pflYsIjMcjpiZMaj30EpXIHFoAUAVk4HjwaDKxTHOwLmF7sNLOQTVBMvnzTnBdxJgJ-y4xm_lH96fHjFRqafe_DuuTM4Fa2bNEHNUqqRhGSc7LjInqycfwj9WiGIjcXhv2KnbQ1PAReyoHBXyk20JO1seIBiOvDsRMP25xcrQPoijz93pgn8XEto3V9W66KDFEsLCwkPGtfhCOZpaMzrtf8y94uCXn_EREAgEMyrPYqD5aFBGQIKPS7euOC6rLJx82wIzGyZctf8cJtrth_Hb9BmBIb3H4IS8n9yGct3s5CZyVP8XEqxkyCBEGjfzlFciYXEgzw9RUmteZYJwcVuw72bfaHc6LLxk8liu-qztytwsOKMfMNpajsOIL3664HTBMxWOfsC_7l2Inlt63rOdJBxKauQ3djLdYKLx_tAE0YuviAMeJQKVWyA9TybJmtfLM2uCtNsKClGu9MoB40vEyElqbfRti6oyEv-LJLtlqzXGKllTjeuBX_dHjafALgdZ5wH8mNipeJs9aiUdDUhbTX-zORumHA1WObwvcENe8lk-UrnUQjlYHC0pxVGSGv1wPl53pXqA61sBG0Qk1AvvVmmc7I5Fly9NcruAq0iZ_kHhuTmgrdBqSByXQlR5PM5TbiLBLQwA8kbIN5iPizd6X-P9Rfvabn71PBOSf1-V-44EfKZ_z.FHIIgngeGq-O7TfWVOAeePPP1i7P9tj0NYpZreEvwUg=</keystore>
        </server-keystore>
      </ssl>
      <signing-keys>
        <signing-key>
          <id>default-signing-key</id>
          <keystore>data:application/p12;aes,v:S.bzVOblJqM1hKaHNXdzZldw==.zmyCxtJdkpqhX6tgU5hiyQ==.7ioV4IUwxnHLRLtwxueJMB4EEf3xVAfTBTQh087-aa6pO0v9LFM_3VVxMBwyDMmoP7vfajZ_PAiBJNYLzW7Z8iZecM7SNtIdqZZUwSDke22j3ScUsnaYWHZ4uXak_7YqELYJ9ZqRseMxdgbXDd8mgnnBXMIP4sxfUF-gzV3WSWEIxV3tPWosZWaazchAIB4JYuf9JtBHv_V9d0JJM4xqNqgofirO_KsVOAaVWb7vcF9VjJEHzrAyu3WaMImesV9cxz64W3-j6CZ6iNgFQAHhI3GYuISZvjdvJLwgtCPp9vEwBd3rSiBNuOvHRfWZcN4-Fy0yFN1ykqhlyhs7qzHmS9rMRDK_61mJHE-ouBRQsLSOWzcuyCTRbg_VfpMaCc-w1-PNiYAA5-5xNfpAW0dMuMdA3vy-76V-uXHybiR-2Xq7qYdy8hAH1kruZmNC9xqsehM-OcvPdM8Za4-JjF2zKPuX_x05DITth9Bdr4hyiuEkuF9aqFyyXtY5CB_EHTDxaPm3x0tAsHq2hwcJxlLXjeqoGoSKZMrIj_2zxDXM03LeUbcQdxfi2kHkFTjV9yr69gnFO-9UvxUtDUGErO-adXJBgKyvFCRABeRdtxKHqnZdzNsoY1r4SPFlg4om7wXvtLSj5h7CXQnFGxcZQlviloIKSiOTZKEWIGGUn-dPD6zgRzGovDO_dsVCuUZZz3DHBMiQEKn_RaJCR6QKrf85PQjBjFarZk8Pz678VURNGEmR1AheDiRHH0cvvulXkNXyFLy-4Y4kqILS7_n2TFoB73T9hf5vTQUUVF8sX7Zi5CEVShn3195T-ndu30MEA256mXCGRidWU60_iLjyMN2MsQ0r-v3RzkVLQIGZ6JRqENn5q05HkDDVKoPHWEOtBpAIht6D3Qi73jIC2V3CI2nvL08ujR0XIWoCHtFkHQjX4jmBSSu5yCMxGkEHwrX3VGXbRqskwLgsV42iBN_E6h_6SuZXvIBe_TxLzg61JOBSACLVExSm30P5A4_qBQrijXUkBJcKizeoWU8B2kwxu0CJuQUfBhO-ZPDEoQCaldYCC6SYa5RmK9DhzkXiR8GxTg_TXG4ThQt9W6t9hvUls1GTx4-fX6p8qBhxeKZDy6RBgaWgzhHAwlAzQMxAzibZxVE1D4OcbwRJ3JGCOrlqGPRd2BMWA0HXkiDs3h-2LelDEv8PhXcRsIz5IAZq8PZ2OqZM9BBfR3z-Su18Z5iyJ0ozDL7m08dKINiGkOjzaoc6XmMdSF18tzc0gxcaZSaKISu-3fZUjdNKzo6BfHcPuv0YljPPTPHhRzxPP3d2aZKfO7Y6lhdQUuiexPYyc3QjumXwI6owCpoqH_uQYw3qCmQAnVCusMAg0E7SyTs3gQe2JrwOR3wA2SimqN2SGKB2ZqVDiEm6KzbxUljh3aRJbf64dYsXaZ3fikbvGpH7PEFyyVnIqY_gzEo3ikOswa87Pj9f0s828gFAz6XX7za49LZIMMUDQMJ7fWgGJPwSnudiCK49uwv8-G_Tu49NV7wEiwb1mvMqVdr0m50JbqZ5YLgXdAKdoytktucnR7awC6Ykcx8wQOqOpkaIwkNAP3h0U48ah3ziSlPXVTdYlez6Hxt0l2GsUUjva8oM2LpvgDz1nRXc1CJh9YKEewqxHHYA_CLSWPfxBGQLKPdwSQdEWHIGVcR9AynbofCEfC2zDElWglBLDRTm_0rrRlFfGiDVyTZuu55QeBthsDQJLDa7X1Muy0QIM9bkQzETU36YCBsjEFw4ur0c21Q5hEiHHh2uXlorpgZFrQcORSVmyhlzcshJF0BVMV9ysf6VOix_WzFGud8ESR5rmHMTLgyLR2HAcynAiprgUyY5pRu2sMa-VSRKI5RFM6Thq1GWVCYzig82M69oWeywGnZqwNOQ47eM0FbIp9oPCB2uz8ktRM3So5FjWMaaNc8ahl4ptvNrVouOhn7mZP3TKbjdmrpQyfMzBnrvPyQeDZKviSRxygPzHWYqUKTXbKcAHrHTHwLHVmnJASrx6u4fyv6208cR-SQRRPavGINZ1xZ6safrPSMk67LTEcRyC-RZnvff5G1B7IXwh3ByMUo0ImfMWG75bmjR-NNmys-D5LrjMiDaC9daZkt3IT3WiI1RySovq76mLA_Z9ymlwjfl4KRFwsWw-MzaJHLkNno7yhZBWuscDWoBNH7e_I53WPruBRq0TB58tmJwc39XjPB8jCfGcTlA4JSICfggQ22sMl3reX-niJKu9uJTsP50rS3N3U4t470Tcjwowv_-_xpTRe6NrsMGI3jSzDOiJ1HLM-oJuoKweG43k3HdsGjBheaObWh69FVAw_HXpesidnwH-47KX0I44EYf7L5-BY0E7YtX4cenemtjo5olvB7jCLTRKCjLRKciPI6rQ14qf5uwcdfbx8lFz0cizgiXfLRO1-ul_KeX1qDebsaLxhfZzlVpfVyBfvOZz_D6t1y9YvdLYABYcTsED00EdiKH6n_rV5mSp7n4mw5p-5zdX4HG5yCd0ezqx0WQbL4w-2ndCXyHLdZ_kWXhvCwS6Y5antU0PXUUeDJM9GeGsNvH2S0pvxFcAm2gnNxRuhQvqL457zzhdnZadUPad6dpIfKo1EmcIfQh9k5fNaAqLLF-cE2s-qADXcXPsOnb5LOtBU9Q6T186Fbn3cdJZJjgQ4fLA1YBqPBCOBq60UaiDBpVV_yQZkRSJp8vZc6frT-eVgJuR4rUnIgrVmYge_DOdAaChFXhOtPj8WQL4VioAEHDrGIHK7ebUTiDUqIlKYa4FtLlL8kMKH3bnd2Lr2fUPgjWA9k_MW8o-5ArbG-BEl6x9kER7ENvN8SFLLoBPo6pm99wQ-nzJKH2p-lZ35i5EX8M1d4tyDpWYK4FQxSD9EI2gDPhGD8O_ehyIIuVc437Ou5COdacM5k7QON9c3VGgfwWF492X1zx2sfGmPCWcAZ3lCRmXVv1W8nPgXADgTDJ52mim4qrkCpoiof2Eyj7ktbXkR7x3lLWBdZq96GoytGF7c33-FLRoGT5RAfgRu57sa4fUEVmidJI3i0OK1hrPLPQistGlaGJHzhIKUiM5PoBwvTgKdH4jyJ4jLJPf2wRzzJwkphY-xNBr7GD6wSSZmbAQcFhyDbu1LNt4RO6TeKXe4LTjhtuOtdpKOxljdSjJ-lBUSaHL3xQEjPLcfj7_NEhZMjYwF6On2d7ndVNL4QLzi2YYKzThZcIi5X4gG9smgYcYKW7Q_EF7w68zj7Uqe08Hgnm47vrxoIJ7qiDLpy8g02IywALMSgI5exaFJsh2gXH0pVF6neCUsJNyeV5-kub40kcFbllY74WM9m76C5VQffJcv0lkSpjdvS34CXw7C_QhfvjI8IAO-41tci8GPZu57lLRtlT2ziRsu0Lfyggnqxk0aYFLkpnzhpDVkT4enrQDKPMPNuR9JPOgiUUaLbzlF01wvbUAID9otgnLzbk_xvAgq5gRSPJokPZHxnlcSNt72WHDxJGjllxMNfOsav7eQXCuY-VIvsigqwxq_ht8KSbsK-T8BQCiDn6w7lEHsPJ4NjKbre7Dh0hGMk4X0ed3A2CWqo0sOXLGRosC_yvgAF4r6V-Wl3LVmrn5CH297S4yolqEY58UtQkHQd9w1Rg.NuaSi2ABIDFBvW_f-_9U612YwuQbdGDFjRU8IfF7Esg=</keystore>
        </signing-key>
      </signing-keys>
      <signature-verification-keys>
        <signature-verification-key>
          <id>default-signature-verification-key</id>
          <keystore>data:application/pem;aes,v:S.MWlBdnd0YkQzb1ExUm4wSQ==.j-EnR82i2InWawrVr5t7rQ==.5sD5U5AdjQ4dOjrqyvytefh3EpiV9QTyyoTzNQPWAR8IBZPllsLXW2A9c2J5d2wQbTwZ_B4t8TOHfkSmxIyeAzHFyCgPEipumaNvT5ynorktY5UTrG2WpQndg7t6GriCM565SoLBhfH0rSs7nlntvV5Np6wBgNi8s6R1_EURlDKeiJbrh3bQgbPKUq60Fj8I-qQPLOc2nKNWXlGtaMFJT7Qo4p75llbtNQOmTfNV9Hdlkw3UWK5o0xe4DwE4lvgGQnDgb4gYCrHM5QzflPOFK-_73KTcGWa7IooY8WOgYNeUhnODU2FEZwZ4ntBr4poos8edBEoUIFRnjq-saWw-miubvfDI3JB0T8A1x9EiGBflBnRmm-RE1o28ofSTT5fZPiYv0rhIH2cNFLj2UkZJraOIEOV-1FezOV_QAzkefPKMYSgUdcnWFrKG7rdZPsqO017wq7pdW6KEWbdGwbK9g48kHkXYXEXKIiIzCKky63dvsbJrncCeYMv9lqCVn6ewqEXNPUAlfWPIhUT_sqtEtBvO0m-ofJ7P-zl3DUy9I8OIa4EZFdTc_yPyTz5LFZCv7dowLm-gwkIHXmwWVUXS9L-0P2nX4FVNyqsdrUuXQVe3AyaJ4reBCMAvL8xx_DXUJi5O-HjBhYZbugxe7I7Y7M3rTlYFRAKmU13OptHA1sqihic6E1XpgtZ59TBz1HbHr0jGDTtAXHSKK6v_GiPxahnz0GhOWjyt8R0y9hwejMLpXW8BeTPYrRUq5Q3U0C2s77GeBvxQcIqed1awOnL1VtZdGyqMwbWjs_Q_SsE6o46Ffk3_AqfQgviv-iT7EY-jfZ7Sr3ZbX2A6K8GuPG8tRagVbLwY6gPneeGF9tM_onJUEeBoMwMGBrQjKJyIxHXiN73eXhcpAfHZnSrExsrsozD8t5SWHZkhiisLbeXncI_BpKbQAYNWcpbMK01j0Y_4yDS-2cjZy__bCKtVYohkE2oExnYhYTmtT3HoZw41J3nrxd2T4-hjQn4SFFFqo9TpHDPc_GlyXeCs-KMsnSQhg-wQfwSzGlVRaf2FigKPrT-h_JM03lyA1PN-fKqXXmWndj2Q1gyEE8Flb8LLws39zrDPoMn4Oc8VcyRn1-KT8tyajx73D_SAbqJKclTZdUuhFy2WghegV4aiO8aKeAlMVlLh1r2xeuWulyWTE50ar5QiCPWQvUaw23HhTf2zkuxF5rnOFM91AqS54XXspVTQGf4gG2NIiwnqB7HYZ_OYXllirSauVqPY182txqdLq9CA5chCxY5YzDnzxxA0VYALk8leckKZjEHainOJw8zbQCOJr8qTP65stbLHOB68f0vbSHG6jn_Rnn5vOfl9AJa_tpt--tfzIbH7i3DP4ZNENDUPlMQ386kcg5bFrM8_uGFu8YJNZ595WaKyxYqXEv6MeShZnicjWtO5w-ZHGJ62SOGkDO4MPDu7wu1YJEfJ1I_3JnsbqV0B_gSzy2L3y5Yq9IvUvvZztIL-TRxmnZ2TKx6h0yHOvVrjOqDqX4Yk6_o87zqYtNzHibU1fOisugbuxKj3BjfxoXqflfogyd9U0FkGOgCLVxDxHcCJzmaW6XgU2kKPjx9EFN9QoQpEGcBrez-CxffygD3pFb2_qN0B6eHGLAPyVeFf-VWiro6y3oq5.SEaihh5ZiGTmyQJSsw_VuXJjLyyBs_q85kkpun6fS58=</keystore>
        </signature-verification-key>
      </signature-verification-keys>
    </crypto>
    <caching-services>
      <default-caching-service>
        <data-source>default-datasource</data-source>
      </default-caching-service>
    </caching-services>
  </facilities>
  <processing xmlns="https://curity.se/ns/conf/base">
    <license-key></license-key>
    <procedures>
      <token-procedure>
        <id>custom</id>
        <flow>oauth-token-token-exchange</flow>
        <script>LyoqCiAqIEBwYXJhbSB7c2UuY3VyaXR5LmlkZW50aXR5c2VydmVyLnByb2NlZHVyZXMuY29udGV4dC5Ub2tlbkV4Y2hhbmdlUHJvY2VkdXJlQ29udGV4dH0gY29udGV4dAogKi8KZnVuY3Rpb24gcmVzdWx0KGNvbnRleHQpIHsKICAgIHZhciBhY2Nlc3NUb2tlbkRhdGEgPSBjb250ZXh0LmdldERlZmF1bHRBY2Nlc3NUb2tlbkRhdGEoY29udGV4dC5kZWxlZ2F0aW9uKTsKCiAgICB2YXIgaXNzdWVkQWNjZXNzVG9rZW47CiAgICBpZiAoY29udGV4dC5jbGllbnQucHJvcGVydGllc1snY3VzdG9tX2p3dF90b2tlbl9leGNoYW5nZSddID09ICd0cnVlJykgewoKICAgICAgICB2YXIgb3JkZXJfdHJhbnNhY3Rpb25faWQgPSBjb250ZXh0LnJlcXVlc3QuZ2V0Rm9ybVBhcmFtZXRlcignb3JkZXJfdHJhbnNhY3Rpb25faWQnKTsKICAgICAgICB2YXIgZXZlbnRfcGF5bG9hZF9oYXNoID0gY29udGV4dC5yZXF1ZXN0LmdldEZvcm1QYXJhbWV0ZXIoJ2V2ZW50X3BheWxvYWRfaGFzaCcpOwogICAgICAgIGlmIChvcmRlcl90cmFuc2FjdGlvbl9pZCAmJiBldmVudF9wYXlsb2FkX2hhc2gpIHsKICAgICAgICAgICAgYWNjZXNzVG9rZW5EYXRhLm9yZGVyX3RyYW5zYWN0aW9uX2lkID0gb3JkZXJfdHJhbnNhY3Rpb25faWQ7CiAgICAgICAgICAgIGFjY2Vzc1Rva2VuRGF0YS5ldmVudF9wYXlsb2FkX2hhc2ggPSBldmVudF9wYXlsb2FkX2hhc2g7CiAgICAgICAgfQoKICAgICAgICB2YXIgbm93ID0gbmV3IERhdGUoKTsKICAgICAgICB2YXIgZnV0dXJlID0gbmV3IERhdGUoKTsKICAgICAgICBmdXR1cmUuc2V0RnVsbFllYXIobm93LmdldEZ1bGxZZWFyKCkgKyAxKTsKICAgICAgICBhY2Nlc3NUb2tlbkRhdGEuZXhwID0gTWF0aC5yb3VuZChmdXR1cmUuZ2V0VGltZSgpIC8gMTAwMCk7CgogICAgICAgIGlzc3VlZEFjY2Vzc1Rva2VuID0gY29udGV4dC5nZXREZWZhdWx0QWNjZXNzVG9rZW5Kd3RJc3N1ZXIoKS5pc3N1ZShhY2Nlc3NUb2tlbkRhdGEsIGNvbnRleHQuZGVsZWdhdGlvbik7CgogICAgfSBlbHNlIHsKICAgICAgICAKICAgICAgICBpc3N1ZWRBY2Nlc3NUb2tlbiA9IGNvbnRleHQuYWNjZXNzVG9rZW5Jc3N1ZXIuaXNzdWUoYWNjZXNzVG9rZW5EYXRhLCBjb250ZXh0LmRlbGVnYXRpb24pOwogICAgfQoKICAgIHJldHVybiB7CiAgICAgICAgc2NvcGU6IGFjY2Vzc1Rva2VuRGF0YS5zY29wZSwKICAgICAgICBhY2Nlc3NfdG9rZW46IGlzc3VlZEFjY2Vzc1Rva2VuLAogICAgICAgIHRva2VuX3R5cGU6ICdiZWFyZXInLAogICAgICAgIGV4cGlyZXNfaW46IHNlY29uZHNVbnRpbChhY2Nlc3NUb2tlbkRhdGEuZXhwKQogICAgfTsKfQ==</script>
      </token-procedure>
      <token-procedure>
        <id>transaction-procedure</id>
        <flow>oauth-token-token-exchange</flow>
        <script>LyoqCiAqIEBwYXJhbSB7c2UuY3VyaXR5LmlkZW50aXR5c2VydmVyLnByb2NlZHVyZXMuY29udGV4dC5Ub2tlbkV4Y2hhbmdlUHJvY2VkdXJlQ29udGV4dH0gY29udGV4dAogKi8KZnVuY3Rpb24gcmVzdWx0KGNvbnRleHQpIHsKCXZhciBhY2Nlc3NUb2tlbkRhdGEgPSBjb250ZXh0LmdldERlZmF1bHRBY2Nlc3NUb2tlbkRhdGEoY29udGV4dC5kZWxlZ2F0aW9uKTsKCiAgICB2YXIgb3JkZXJfdHJhbnNhY3Rpb25faWQgPSBjb250ZXh0LnJlcXVlc3QuZ2V0Rm9ybVBhcmFtZXRlcignb3JkZXJfdHJhbnNhY3Rpb25faWQnKTsKICAgIHZhciByZXF1ZXN0X2NvbnRlbnRfaGFzaCA9IGNvbnRleHQucmVxdWVzdC5nZXRGb3JtUGFyYW1ldGVyKCdyZXF1ZXN0X2NvbnRlbnRfaGFzaCcpOwogICAgaWYgKG9yZGVyX3RyYW5zYWN0aW9uX2lkICYmIHJlcXVlc3RfY29udGVudF9oYXNoKSB7CiAgICAgICAgYWNjZXNzVG9rZW5EYXRhLm9yZGVyX3RyYW5zYWN0aW9uX2lkID0gb3JkZXJfdHJhbnNhY3Rpb25faWQ7CiAgICAgICAgYWNjZXNzVG9rZW5EYXRhLnJlcXVlc3RfY29udGVudF9oYXNoID0gcmVxdWVzdF9jb250ZW50X2hhc2g7CiAgICB9CgoJLy92YXIgaXNzdWVkQWNjZXNzVG9rZW4gPSBjb250ZXh0LmFjY2Vzc1Rva2VuSXNzdWVyLmlzc3VlKGFjY2Vzc1Rva2VuRGF0YSwgY29udGV4dC5kZWxlZ2F0aW9uKTsKICAgIHZhciBpc3N1ZWRBY2Nlc3NUb2tlbiA9IGNvbnRleHQuZ2V0RGVmYXVsdEFjY2Vzc1Rva2VuSnd0SXNzdWVyKCkuaXNzdWUoYWNjZXNzVG9rZW5EYXRhLCBjb250ZXh0LmRlbGVnYXRpb24pOwoKCXJldHVybiB7CgkJc2NvcGU6IGFjY2Vzc1Rva2VuRGF0YS5zY29wZSwKCQlhY2Nlc3NfdG9rZW46IGlzc3VlZEFjY2Vzc1Rva2VuLAoJCXRva2VuX3R5cGU6ICdiZWFyZXInLAoJCWV4cGlyZXNfaW46IHNlY29uZHNVbnRpbChhY2Nlc3NUb2tlbkRhdGEuZXhwKQoJfTsKfQ==</script>
      </token-procedure>
    </procedures>
    <account-managers>
      <account-manager>
        <id>default-account-manager</id>
        <enable-registration>
          <account-verification-method>no-verification</account-verification-method>
        </enable-registration>
        <account-data-source>default-datasource</account-data-source>
      </account-manager>
    </account-managers>
    <credential-managers>
      <credential-manager>
        <id>default-credential-manager</id>
        <Sha2WithSha256>
        </Sha2WithSha256>
        <data-source-backed>
          <data-source-id>default-datasource</data-source-id>
        </data-source-backed>
      </credential-manager>
    </credential-managers>
  </processing>
  <nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm">
    <write-default>permit</write-default>
    <groups>
      <group>
        <name>admin</name>
        <user-name>admin</user-name>
      </group>
    </groups>
    <rule-list>
      <name>admin</name>
      <group>admin</group>
      <rule>
        <name>any-access</name>
        <action>permit</action>
      </rule>
    </rule-list>
    <rule-list>
      <name>any-group</name>
      <group>*</group>
      <rule>
        <name>tailf-aaa-authentication</name>
        <module-name>tailf-aaa</module-name>
        <path>/aaa/authentication/users/user[name='$USER']</path>
        <access-operations>read update</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-aaa-user</name>
        <module-name>tailf-aaa</module-name>
        <path>/user[name='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-webui-user</name>
        <module-name>tailf-webui</module-name>
        <path>/webui/data-stores/user-profile[username='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
    </rule-list>
  </nacm>
  <aaa xmlns="http://tail-f.com/ns/aaa/1.1">
    <authentication>
      <users>
        <user>
          <name>admin</name>
          <uid>0</uid>
          <gid>0</gid>
          <password>$5$m7y0GfCi$uuWsjLks5Wf8k2oPKy09h1MffQeqXYg6R7JdhT.eR68</password>
          <ssh_keydir>/opt/idsvr/home/admin/.ssh</ssh_keydir>
          <homedir>/opt/idsvr/home/admin</homedir>
        </user>
      </users>
    </authentication>
    <ios>
      <level>
        <nr>0</nr>
        <prompt>\h> </prompt>
      </level>
      <level>
        <nr>15</nr>
        <prompt>\h# </prompt>
      </level>
      <privilege>
        <mode>exec</mode>
        <level>
          <nr>0</nr>
          <command>
            <name>action</name>
          </command>
          <command>
            <name>autowizard</name>
          </command>
          <command>
            <name>enable</name>
          </command>
          <command>
            <name>exit</name>
          </command>
          <command>
            <name>help</name>
          </command>
          <command>
            <name>startup</name>
          </command>
        </level>
        <level>
          <nr>15</nr>
          <command>
            <name>configure</name>
          </command>
        </level>
      </privilege>
    </ios>
  </aaa>
</config>